require=(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var rawAsap=require("./raw"),freeTasks=[],pendingErrors=[],requestErrorThrow=rawAsap.makeRequestCallFromTimer(throwFirstError);function throwFirstError(){if(pendingErrors.length)throw pendingErrors.shift()}module.exports=asap;function asap(a){var b;b=freeTasks.length?freeTasks.pop():new RawTask,b.task=a,rawAsap(b)}function RawTask(){this.task=null}RawTask.prototype.call=function(){try{this.task.call()}catch(a){asap.onerror?asap.onerror(a):(pendingErrors.push(a),requestErrorThrow())}finally{this.task=null,freeTasks[freeTasks.length]=this}};

},{"./raw":2}],2:[function(require,module,exports){
(function (global){
"use strict";module.exports=rawAsap;function rawAsap(a){queue.length||(requestFlush(),flushing=!0),queue[queue.length]=a}var requestFlush,queue=[],flushing=!1,index=0,capacity=1024;function flush(){for(;index<queue.length;){var a=index;if(++index,queue[a].call(),index>capacity){for(var b=0,c=queue.length-index;b<c;b++)queue[b]=queue[b+index];queue.length-=index,index=0}}queue.length=0,index=0,flushing=!1}var scope="undefined"==typeof global?self:global,BrowserMutationObserver=scope.MutationObserver||scope.WebKitMutationObserver;requestFlush="function"==typeof BrowserMutationObserver?makeRequestCallFromMutationObserver(flush):makeRequestCallFromTimer(flush),rawAsap.requestFlush=requestFlush;function makeRequestCallFromMutationObserver(a){var b=1,c=new BrowserMutationObserver(a),d=document.createTextNode("");return c.observe(d,{characterData:!0}),function(){b=-b,d.data=b}}function makeRequestCallFromTimer(a){return function(){function b(){clearTimeout(c),clearInterval(d),a()}var c=setTimeout(b,0),d=setInterval(b,50)}}rawAsap.makeRequestCallFromTimer=makeRequestCallFromTimer;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],3:[function(require,module,exports){
(function (process,global){
"use strict";module.exports=process.hrtime||hrtime;var performance=global.performance||{},performanceNow=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return new Date().getTime()};function hrtime(a){var b=Math.floor,c=1e-3*performanceNow.call(performance),d=b(c),e=b(1e9*(c%1));return a&&(d-=a[0],e-=a[1],0>e&&(d--,e+=1e9)),[d,e]}

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":43}],4:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var ServiceLocator=function(){function a(){_classCallCheck(this,a),this._registrations=Object.create(null)}return _createClass(a,[{key:'register',value:function register(a,b,c){this._throwIfNotFunction(a,b),this._throwIfNotString(a),this._initializeRegistration(a),this._registrations[a].unshift({Implementation:b,isSingleton:!!c,singleInstance:null})}},{key:'registerInstance',value:function registerInstance(a,b){this._throwIfNotString(a),this._initializeRegistration(a),this._registrations[a].unshift({Implementation:b.constructor,isSingleton:!0,singleInstance:b})}},{key:'resolve',value:function resolve(a){this._throwIfNotString(a),this._throwIfNoType(a);var b=this._registrations[a][0];return this._createInstance(b)}},{key:'resolveAll',value:function resolveAll(a){var b=this;return this._throwIfNotString(a),this._throwIfNoType(a),this._registrations[a].map(function(a){return b._createInstance(a)})}},{key:'unregister',value:function unregister(a){this._throwIfNotString(a),this._registrations[a]=[]}},{key:'has',value:function has(a){return this._throwIfNotString(a),a in this._registrations&&0<this._registrations[a].length}},{key:'_createInstance',value:function _createInstance(a){if(a.isSingleton&&null!==a.singleInstance)return a.singleInstance;var b=new a.Implementation(this);return a.isSingleton&&(a.singleInstance=b),b}},{key:'_initializeRegistration',value:function _initializeRegistration(a){a in this._registrations||(this._registrations[a]=[])}},{key:'_throwIfNoType',value:function _throwIfNoType(a){if(!(a in this._registrations&&0<this._registrations[a].length))throw new Error('Type "'+a+'" not registered')}},{key:'_throwIfNotFunction',value:function _throwIfNotFunction(a,b){if(!(b instanceof Function))throw new Error('Constructor for type '+a+' should be a function')}},{key:'_throwIfNotString',value:function _throwIfNotString(a){if('string'!=typeof a)throw new Error('Type name "'+a+'" should be a string')}}]),a}();module.exports=ServiceLocator;

},{}],5:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(e===void 0){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if('value'in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)};function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var LoggerBase=require('../lib/LoggerBase'),Logger=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:'write',value:function write(a,b){if(!(a<this._level))if(50<=a){var c=b instanceof Error?b.name+': '+b.message+'\n'+b.stack:b;console.error(c)}else 40<=a?console.warn(b):30<=a?console.info(b):console.log(b)}},{key:'wrapEventBus',value:function wrapEventBus(a){var c=this;_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'wrapEventBus',this).call(this,a);var d=this._locator.resolve('window');d.onerror=function(a,b,d){return c.fatal(b+':'+d+' '+a),!0},20<this._level||a.on('documentUpdated',function(a){return c.debug('Document updated ('+a.length+' store(s) changed)')}).on('componentBound',function(a){var b=a.id?'#'+a.id:'';c.debug('Component "'+a.element.tagName+b+'" is bound')}).on('componentUnbound',function(a){var b=a.id?'#'+a.id:'';c.debug('Component "'+a.element.tagName+b+'" is unbound')})}}]),b}(LoggerBase);module.exports=Logger;

},{"../lib/LoggerBase":6}],6:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var DEFAULT_LEVEL=30,DEFAULT_NAME='catberry',prettyHrTime=require('pretty-hrtime'),LoggerBase=function(){function a(b){_classCallCheck(this,a);var c=b.resolve('config').logger||{};this._locator=b,this._level='number'==typeof c.level?c.level:DEFAULT_LEVEL,this._name='string'==typeof c.name?c.name:DEFAULT_NAME;var d=b.resolve('eventBus');this.wrapEventBus(d)}return _createClass(a,[{key:'trace',value:function trace(a){this.write(10,a)}},{key:'debug',value:function debug(a){this.write(20,a)}},{key:'info',value:function info(a){this.write(30,a)}},{key:'warn',value:function warn(a){this.write(40,a)}},{key:'error',value:function error(a){this.write(50,a)}},{key:'fatal',value:function fatal(a){this.write(60,a)}},{key:'wrapEventBus',value:function wrapEventBus(a){var b=this;50<this._level||(a.on('error',function(a){return b.error(a)}),!(40<this._level))&&(a.on('warn',function(a){return b.warn(a)}),!(30<this._level))&&(a.on('info',function(a){return b.info(a)}).on('componentLoaded',function(a){return b.info('Component "'+a.name+'" loaded')}).on('storeLoaded',function(a){return b.info('Store "'+a.name+'" loaded')}).on('allStoresLoaded',function(){return b.info('All stores loaded')}).on('allComponentsLoaded',function(){return b.info('All components loaded')}),!(20<this._level))&&(a.on('debug',function(a){return b.debug(a)}).on('componentRender',function(a){var c=getId(a.context),d=getTagNameForComponentName(a.name);b.debug('Component "'+d+c+'" is being rendered...')}).on('componentRendered',function(a){var c=getId(a.context),d=getTagNameForComponentName(a.name),e=Array.isArray(a.hrTime)?' ('+prettyHrTime(a.hrTime)+')':'';b.debug('Component "'+d+c+'" rendered'+e)}).on('documentRendered',function(a){return b.debug('Document rendered for URI '+a.location.toString())}),10<this._level||a.on('trace',function(a){return b.trace(a)}))}}]),a}();function getId(a){var b=a.attributes.id;return b?'#'+b:''}function getTagNameForComponentName(a){if('string'!=typeof a)return'';var b=a.toUpperCase();return'HEAD'===a?b:'DOCUMENT'===a?'HTML':'CAT-'+b}module.exports=LoggerBase;

},{"pretty-hrtime":42}],7:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var UHRBase=require('../lib/UHRBase'),NON_SAFE_HEADERS={cookie:!0,"accept-charset":!0},UHR=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.window=a.resolve('window'),c}return _inherits(b,a),_createClass(b,[{key:'_doRequest',value:function _doRequest(a){var b=this;return Object.keys(a.headers).forEach(function(b){NON_SAFE_HEADERS.hasOwnProperty(b.toLowerCase())&&delete a.headers[b]}),new Promise(function(c,d){var e=new b.window.XMLHttpRequest,f=null;e.onabort=function(){f=new Error('Request aborted'),d(f)},e.ontimeout=function(){f=new Error('Request timeout'),d(f)},e.onerror=function(){f=new Error(e.statusText||'Connection error'),d(f)},e.onreadystatechange=function(){if(4===e.readyState&&!f){var a=b._getStatusObject(e),d=b.convertResponse(a.headers,e.responseText);c({status:a,content:d})}};var g=a.uri.authority.userInfo?a.uri.authority.userInfo.user:null,h=a.uri.authority.userInfo?a.uri.authority.userInfo.password:null;e.open(a.method,a.uri.toString(),!0,g||void 0,h||void 0),e.timeout=a.timeout,a.withCredentials&&(e.withCredentials=!0),Object.keys(a.headers).forEach(function(b){return e.setRequestHeader(b,a.headers[b])}),e.send(a.data)})}},{key:'_getStatusObject',value:function _getStatusObject(a){var b={};return a?(a.getAllResponseHeaders().split('\n').forEach(function(a){var c=a.indexOf(':');if(!(0>=c)){var d=a.substring(0,c).trim().toLowerCase();b[d]=a.substring(c+1).trim()}}),{code:1223===a.status?204:a.status,text:1223===a.status?'No Content':a.statusText,headers:b}):{code:0,text:'',headers:b}}}]),b}(UHRBase);module.exports=UHR;

},{"../lib/UHRBase":8}],8:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var catberryUri=require('catberry-uri'),Query=catberryUri.Query,URI=catberryUri.URI,DEFAULT_TIMEOUT=3e4,HTTP_PROTOCOL_REGEXP=/^(http)s?$/i,UHRBase=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:'get',value:function get(b,c){return this.request(this._normalizeOptions(a.METHODS.GET,b,c))}},{key:'post',value:function post(b,c){return this.request(this._normalizeOptions(a.METHODS.POST,b,c))}},{key:'put',value:function put(b,c){return this.request(this._normalizeOptions(a.METHODS.PUT,b,c))}},{key:'patch',value:function patch(b,c){return this.request(this._normalizeOptions(a.METHODS.PATCH,b,c))}},{key:'delete',value:function _delete(b,c){return this.request(this._normalizeOptions(a.METHODS.DELETE,b,c))}},{key:'request',value:function request(a){var b=this;return this._validateRequest(a).then(function(a){return b._doRequest(a)})}},{key:'_validateRequest',value:function _validateRequest(b){if(!b||'object'!==('undefined'==typeof b?'undefined':_typeof(b)))return Promise.reject(new Error('Request parameters argument should be an object'));var c=Object.create(b);if('string'!=typeof b.url)return Promise.reject(new Error('"parameters.url" is a required parameter'));if(c.uri=new URI(c.url),!c.uri.scheme)return Promise.reject(new Error('"parameters.url" should contain a protocol (scheme)'));if(!HTTP_PROTOCOL_REGEXP.test(c.uri.scheme))return Promise.reject(new Error('"'+c.uri.scheme+'" protocol (scheme) is unsupported'));if(!c.uri.authority||!c.uri.authority.host)return Promise.reject(new Error('"parameters.url" should contain a host'));if('string'!=typeof c.method||!(c.method in a.METHODS))return Promise.reject(new Error('HTTP method is a required parameter'));if(c.timeout=c.timeout||DEFAULT_TIMEOUT,'number'!=typeof c.timeout)return Promise.reject(new Error('Timeout should be a number'));if(c.headers=this.createHeaders(c.headers),!this._isUpstreamRequest(b.method)&&c.data&&'object'===_typeof(c.data)){var d=Object.keys(c.data);0<d.length&&!c.uri.query&&(c.uri.query=new Query('')),d.forEach(function(a){c.uri.query.values[a]=c.data[a]}),c.data=null}else{var e=this._getDataToSend(c.headers,c.data);c.headers=e.headers,c.data=e.data}return Promise.resolve(c)}},{key:'_getDataToSend',value:function _getDataToSend(b,c){var d=this._findContentType(b),e=d.name,f=d.type;if(!c||'object'!==('undefined'==typeof c?'undefined':_typeof(c)))return c=c?c+'':'',f||(b[e]=a.PLAIN_TEXT_ENTITY_CONTENT_TYPE),{headers:b,data:c};if(f===a.TYPES.JSON)return{headers:b,data:JSON.stringify(c)};b[e]=a.URL_ENCODED_ENTITY_CONTENT_TYPE;var g=new Query;return g.values=c,{headers:b,data:g.toString().replace(/\+/g,'%2B').replace(/%20/g,'+')}}},{key:'createHeaders',value:function createHeaders(b){b&&'object'===('undefined'==typeof b?'undefined':_typeof(b))||(b={});var c={};return Object.keys(a.DEFAULT_GENERAL_HEADERS).forEach(function(b){c[b]=a.DEFAULT_GENERAL_HEADERS[b]}),Object.keys(b).forEach(function(a){return null===b[a]||void 0===b[a]?void delete c[a]:void(c[a]=b[a])}),c}},{key:'_doRequest',value:function _doRequest(){}},{key:'convertResponse',value:function convertResponse(b,c){'string'!=typeof c&&(c='');var d=this._findContentType(b),e=d.type||a.TYPES.PLAIN_TEXT;switch(e){case a.TYPES.JSON:try{return JSON.parse(c)||{}}catch(a){return{}}case a.TYPES.URL_ENCODED:try{var f=new Query(c.replace('+','%20'));return f.values||{}}catch(a){return{}}default:return c;}}},{key:'_isUpstreamRequest',value:function _isUpstreamRequest(b){return b===a.METHODS.POST||b===a.METHODS.PUT||b===a.METHODS.PATCH}},{key:'_normalizeOptions',value:function _normalizeOptions(a,b,c){c=c||{};var d=Object.create(c);return d.method=a,d.url=b,d}},{key:'_findContentType',value:function _findContentType(a){var b='',c='Content-Type';Object.keys(a).forEach(function(d){'content-type'!==d.toLowerCase()||(c=d,b=a[d])});var d=b.split(';'),e=d[0].toLowerCase();return{name:c,type:e}}}],[{key:'METHODS',get:function get(){return{GET:'GET',HEAD:'HEAD',POST:'POST',PUT:'PUT',PATCH:'PATCH',DELETE:'DELETE',OPTIONS:'OPTIONS',TRACE:'TRACE',CONNECT:'CONNECT'}}},{key:'TYPES',get:function get(){return{URL_ENCODED:'application/x-www-form-urlencoded',JSON:'application/json',PLAIN_TEXT:'text/plain',HTML:'text/html'}}},{key:'CHARSET',get:function get(){return'UTF-8'}},{key:'DEFAULT_GENERAL_HEADERS',get:function get(){return{Accept:a.TYPES.JSON+'; q=0.7, '+a.TYPES.HTML+'; q=0.2, '+a.TYPES.PLAIN_TEXT+'; q=0.1',"Accept-Charset":a.CHARSET+'; q=1'}}},{key:'CHARSET_PARAMETER',get:function get(){return'; charset='+a.CHARSET}},{key:'URL_ENCODED_ENTITY_CONTENT_TYPE',get:function get(){return a.TYPES.URL_ENCODED+a.CHARSET_PARAMETER}},{key:'JSON_ENTITY_CONTENT_TYPE',get:function get(){return a.TYPES.JSON+a.CHARSET_PARAMETER}},{key:'PLAIN_TEXT_ENTITY_CONTENT_TYPE',get:function get(){return a.TYPES.PLAIN_TEXT+a.CHARSET_PARAMETER}}]),a}();module.exports=UHRBase;

},{"catberry-uri":9}],9:[function(require,module,exports){
'use strict';module.exports={URI:require('./lib/URI'),Authority:require('./lib/Authority'),UserInfo:require('./lib/UserInfo'),Query:require('./lib/Query')};

},{"./lib/Authority":10,"./lib/Query":11,"./lib/URI":12,"./lib/UserInfo":13}],10:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var UserInfo=require('./UserInfo'),percentEncodingHelper=require('./percentEncodingHelper'),PORT_REGEXP=/^\d+$/,ERROR_PORT='URI authority port must satisfy expression '+PORT_REGEXP.toString(),Authority=function(){function a(b){if(_classCallCheck(this,a),this.userInfo=null,this.port=null,this.host=null,'string'==typeof b&&0<b.length){var c=b.indexOf('@');if(-1!==c){var d=b.substring(0,c);this.userInfo=new UserInfo(d),b=b.substring(c+1)}var e=b.lastIndexOf(':');if(-1!==e){var f=b.substring(e+1);e===b.length-1?(this.port='',b=b.substring(0,e)):PORT_REGEXP.test(f)&&(this.port=f,b=b.substring(0,e))}this.host=percentEncodingHelper.decode(b)}}return _createClass(a,[{key:'createUserInfo',value:function createUserInfo(b){return a.createUserInfo(b)}}],[{key:'createUserInfo',value:function createUserInfo(a){return new UserInfo(a)}}]),_createClass(a,[{key:'clone',value:function clone(){var b=new a;return this.userInfo&&(b.userInfo=this.userInfo.clone()),'string'==typeof this.host&&(b.host=this.host),'string'==typeof this.port&&(b.port=this.port),b}},{key:'toString',value:function toString(){var a='';if(this.userInfo instanceof UserInfo&&(a+=this.userInfo.toString()+'@'),void 0!==this.host&&null!==this.host){var b=this.host+'';a+=percentEncodingHelper.encodeHost(b)}if(void 0!==this.port&&null!==this.port){var c=this.port+'';if(0<c.length&&!PORT_REGEXP.test(c))throw new Error(ERROR_PORT);a+=':'+c}return a}}]),a}();module.exports=Authority;

},{"./UserInfo":13,"./percentEncodingHelper":14}],11:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var percentEncodingHelper=require('./percentEncodingHelper'),Query=function(){function a(b){var c=this;_classCallCheck(this,a),this.values=null,'string'==typeof b&&(this.values={},b.split('&').forEach(function(a){var b=a.split('='),d=percentEncodingHelper.decode(b[0]);if(d){d in c.values&&!(c.values[d]instanceof Array)&&(c.values[d]=[c.values[d]]);var e='string'==typeof b[1]?percentEncodingHelper.decode(b[1]):null;c.values[d]instanceof Array?c.values[d].push(e):c.values[d]=e}},this))}return _createClass(a,[{key:'clone',value:function clone(){var b=this,c=new a;return this.values&&(c.values={},Object.keys(this.values).forEach(function(a){c.values[a]=b.values[a]},this)),c}},{key:'toString',value:function toString(){var a=this;if(!this.values)return'';var b='';return Object.keys(this.values).forEach(function(c){var d=a.values[c]instanceof Array?a.values[c]:[a.values[c]];d.forEach(function(a){b+='&'+percentEncodingHelper.encodeQuerySubComponent(c),void 0===a||null===a||(a+='',b+='='+percentEncodingHelper.encodeQuerySubComponent(a))})},this),b.replace(/^&/,'')}}]),a}();module.exports=Query;

},{"./percentEncodingHelper":14}],12:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var percentEncodingHelper=require('./percentEncodingHelper'),Authority=require('./Authority'),Query=require('./Query'),URI_PARSE_REGEXP=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,SCHEME_REGEXP=/^[a-z]+[a-z\d\+\.-]*$/i,ERROR_SCHEME='URI scheme must satisfy expression '+SCHEME_REGEXP.toString(),URI=function(){function a(b){_classCallCheck(this,a),this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,'string'!=typeof b&&(b='');var c=b.match(URI_PARSE_REGEXP);c&&('string'==typeof c[2]&&(this.scheme=percentEncodingHelper.decode(c[2])),'string'==typeof c[4]&&(this.authority=a.createAuthority(c[4])),'string'==typeof c[5]&&(this.path=percentEncodingHelper.decodePath(c[5])),'string'==typeof c[7]&&(this.query=a.createQuery(c[7])),'string'==typeof c[9]&&(this.fragment=percentEncodingHelper.decode(c[9])))}return _createClass(a,[{key:'createAuthority',value:function createAuthority(b){return a.createAuthority(b)}},{key:'createUserInfo',value:function createUserInfo(b){return a.createUserInfo(b)}},{key:'createQuery',value:function createQuery(b){return a.createQuery(b)}}],[{key:'createAuthority',value:function createAuthority(a){return new Authority(a)}},{key:'createUserInfo',value:function createUserInfo(a){return Authority.createUserInfo(a)}},{key:'createQuery',value:function createQuery(a){return new Query(a)}}]),_createClass(a,[{key:'resolveRelative',value:function resolveRelative(a){if(!a.scheme)throw new Error('Scheme component is required to be present in a base URI');return transformReference(a,this)}},{key:'clone',value:function clone(){var b=new a;return'string'==typeof this.scheme&&(b.scheme=this.scheme),this.authority&&(b.authority=this.authority.clone()),'string'==typeof this.path&&(b.path=this.path),this.query&&(b.query=this.query.clone()),'string'==typeof this.fragment&&(b.fragment=this.fragment),b}},{key:'toString',value:function toString(){var a='';if(void 0!==this.scheme&&null!==this.scheme){var c=this.scheme+'';if(!SCHEME_REGEXP.test(c))throw new Error(ERROR_SCHEME);a+=c+':'}this.authority instanceof Authority&&(a+='//'+this.authority.toString());var b=void 0===this.path||null===this.path?'':this.path+'';if(a+=percentEncodingHelper.encodePath(b),this.query instanceof Query&&(a+='?'+this.query.toString()),void 0!==this.fragment&&null!==this.fragment){var d=this.fragment+'';a+='#'+percentEncodingHelper.encodeFragment(d)}return a}}]),a}();function transformReference(a,b){var c=new URI('');return b.scheme?(c.scheme=b.scheme,c.authority=b.authority?b.authority.clone():b.authority,c.path=removeDotSegments(b.path),c.query=b.query?b.query.clone():b.query):(b.authority?(c.authority=b.authority?b.authority.clone():b.authority,c.path=removeDotSegments(b.path),c.query=b.query?b.query.clone():b.query):(''===b.path?(c.path=a.path,c.query=b.query?b.query.clone():a.query?a.query.clone():a.query):('/'===b.path[0]?c.path=removeDotSegments(b.path):(c.path=merge(a,b),c.path=removeDotSegments(c.path)),c.query=b.query?b.query.clone():b.query),c.authority=a.authority?a.authority.clone():a.authority),c.scheme=a.scheme),c.fragment=b.fragment,c}function merge(a,b){if(a.authority&&''===a.path)return'/'+b.path;var c=-1===a.path.indexOf('/')?'':a.path.replace(/\/[^\/]+$/,'/');return c+b.path}function removeDotSegments(a){if(!a)return'';for(var b=a,c='',d='',e='';0!==b.length;){if(c=b.replace(/^\.?\.\//,''),c!==b){b=c;continue}if(c=b.replace(/^((\/\.\/)|(\/\.$))/,'/'),c!==b){b=c;continue}if(c=b.replace(/^((\/\.\.\/)|(\/\.\.$))/,'/'),c!==b){e=e.replace(/\/[^\/]+$/,''),b=c;continue}if('.'===b||'..'===b)break;d=/^\/?[^\/]*(\/|$)/.exec(b)[0],d=d.replace(/([^\/])(\/$)/,'$1'),b=b.substring(d.length),e+=d}return e}module.exports=URI;

},{"./Authority":10,"./Query":11,"./percentEncodingHelper":14}],13:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var percentEncodingHelper=require('./percentEncodingHelper'),UserInfo=function(){function a(b){if(_classCallCheck(this,a),this.user=null,this.password=null,'string'==typeof b&&0<b.length){var c=b.split(':');'string'==typeof c[0]&&(this.user=percentEncodingHelper.decode(c[0])),'string'==typeof c[1]&&(this.password=percentEncodingHelper.decode(c[1]))}}return _createClass(a,[{key:'clone',value:function clone(){var b=new a;return'string'==typeof this.user&&(b.user=this.user),'string'==typeof this.password&&(b.password=this.password),b}},{key:'toString',value:function toString(){var a='';if(void 0!==this.user&&null!==this.user){var b=this.user+'';a+=percentEncodingHelper.encodeUserInfoSubComponent(b)}if(void 0!==this.password&&null!==this.password){var c=this.password+'';a+=':'+percentEncodingHelper.encodeUserInfoSubComponent(c)}return a}}]),a}();module.exports=UserInfo;

},{"./percentEncodingHelper":14}],14:[function(require,module,exports){
'use strict';module.exports={encodeUserInfoSubComponent:function encodeUserInfoSubComponent(a){return a.replace(/[^\w\.~\-!\$&'\(\)\*\+,;=\uD800-\uDBFF\uDC00-\uDFFF]/g,encodeURIComponent)},encodeHost:function encodeHost(a){return a.replace(/[^\w\.~\-!\$&'\(\)\*\+,;=:\[\]\uD800-\uDBFF\uDC00-\uDFFF]/g,encodeURIComponent)},encodePath:function encodePath(a){return a.split(/%2f/i).map(function(a){return a.replace(/[^\w\.~\-!\$&'\(\)\*\+,;=:@\/\uD800-\uDBFF\uDC00-\uDFFF]/g,encodeURIComponent)}).reduce(function(a,b){return a?a+'%2F'+b:b},'')},encodeQuerySubComponent:function encodeQuerySubComponent(a){return a.replace(/[^\w\.~\-!\$'\(\)\*,;:@\/\?\uD800-\uDBFF\uDC00-\uDFFF]/g,encodeURIComponent)},encodeFragment:function encodeFragment(a){return a.replace(/[^\w\.~\-!\$&'\(\)\*\+,;=:@\/\?\uD800-\uDBFF\uDC00-\uDFFF]/g,encodeURIComponent)},decode:function decode(a){return decodeURIComponent(a)},decodePath:function decodePath(a){return a.split(/%2f/i).map(decodeURIComponent).reduce(function(a,b){return a?a+'%2F'+b:b},'')}};

},{}],15:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(e===void 0){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if('value'in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)};function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var Catberry=require('./Catberry.js'),BootstrapperBase=require('../lib/base/BootstrapperBase'),StoreDispatcher=require('../lib/StoreDispatcher'),ModuleApiProvider=require('./providers/ModuleApiProvider'),CookieWrapper=require('./CookieWrapper'),Bootstrapper=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,Catberry))}return _inherits(b,a),_createClass(b,[{key:'configure',value:function configure(a,c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'configure',this).call(this,a,c),c.register('storeDispatcher',StoreDispatcher,!0),c.register('moduleApiProvider',ModuleApiProvider,!0),c.register('cookieWrapper',CookieWrapper,!0),c.registerInstance('window',window)}}]),b}(BootstrapperBase);module.exports=new Bootstrapper;

},{"../lib/StoreDispatcher":27,"../lib/base/BootstrapperBase":28,"./Catberry.js":16,"./CookieWrapper":17,"./providers/ModuleApiProvider":23}],16:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var CatberryBase=require('../lib/base/CatberryBase'),Promise=require('promise');'Promise'in window||(window.Promise=Promise);var Catberry=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a._router=null,a}return _inherits(b,a),_createClass(b,[{key:'wrapDocument',value:function wrapDocument(){var a=this,b=require('appDefinitions');b.routeDefinitions.forEach(function(b){return a.locator.registerInstance('routeDefinition',b)}),b.routeDescriptors.forEach(function(b){return a.locator.registerInstance('routeDescriptor',b)}),b.stores.forEach(function(b){return a.locator.registerInstance('store',b)}),b.components.forEach(function(b){return a.locator.registerInstance('component',b)}),this._router=this.locator.resolve('requestRouter')}},{key:'startWhenReady',value:function startWhenReady(){var a=this;return window.catberry?Promise.resolve():new Promise(function(b,c){window.document.addEventListener('DOMContentLoaded',function(){try{a.wrapDocument(),window.catberry=a,b()}catch(a){c(a)}})})}}]),b}(CatberryBase);module.exports=Catberry;

},{"../lib/base/CatberryBase":29,"appDefinitions":"appDefinitions","promise":44}],17:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var CookieWrapperBase=require('../lib/base/CookieWrapperBase'),CookieWrapper=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c._window=a.resolve('window'),c}return _inherits(b,a),_createClass(b,[{key:'getCookieString',value:function getCookieString(){return this._window.document.cookie?this._window.document.cookie.toString():''}},{key:'set',value:function set(a){var b=this._convertToCookieSetup(a);return this._window.document.cookie=b,b}}]),b}(CookieWrapperBase);module.exports=CookieWrapper;

},{"../lib/base/CookieWrapperBase":30}],18:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var morphdom=require('morphdom'),uuid=require('uuid'),errorHelper=require('../lib/helpers/errorHelper'),moduleHelper=require('../lib/helpers/moduleHelper'),hrTimeHelper=require('../lib/helpers/hrTimeHelper'),DocumentRendererBase=require('../lib/base/DocumentRendererBase'),SPECIAL_IDS={$$head:'$$head',$$document:'$$document'},TAG_NAMES={HEAD:'HEAD',STYLE:'STYLE',SCRIPT:'SCRIPT',LINK:'LINK'},NON_BUBBLING_EVENTS={abort:!0,blur:!0,error:!0,focus:!0,load:!0,mouseenter:!0,mouseleave:!0,resize:!0,unload:!0},DocumentRenderer=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c._componentInstances=Object.create(null),c._componentElements=Object.create(null),c._componentBindings=Object.create(null),c._currentChangedStores=Object.create(null),c._window=a.resolve('window'),c._config=a.resolve('config'),c._storeDispatcher=a.resolve('storeDispatcher'),c._renderedPromise=null,c._isUpdating=!1,c._awaitingRouting=null,c._currentRoutingContext=null,c._eventBus.on('storeChanged',function(a){c._currentChangedStores[a]=!0,c._isStateChanging||c._updateStoreComponents()}),c}return _inherits(b,a),_createClass(b,[{key:'initWithState',value:function initWithState(a,b){var c=this;return this._getPromiseForReadyState().then(function(){return c._currentRoutingContext=b,c._storeDispatcher.setState(a,b)}).then(function(){var a=c._componentLoader.getComponentsByNames(),b=c._window.document.documentElement;return c._traverseComponents([b],a,function action(b){return c._initializeComponent(b,a)})}).then(function(){return c._eventBus.emit('documentRendered',c._currentRoutingContext)})}},{key:'render',value:function render(a,b){var c=this;return(this._awaitingRouting={state:a,routingContext:b},this._isStateChanging)?this._renderedPromise:(this._isStateChanging=!0,this._renderedPromise=this._getPromiseForReadyState().then(function(){return c._updateStoreComponents()}).catch(function(a){return c._eventBus.emit('error',a)}).then(function(){c._isStateChanging=!1}),this._renderedPromise)}},{key:'renderComponent',value:function renderComponent(a,b){var c=this;return this._getPromiseForReadyState().then(function(){var d=c._getId(a),e=moduleHelper.getOriginalComponentName(a.tagName);b||(b=c._createRenderingContext([]),b.rootIds[d]=!0);var f=0<a.children.length,g=b.components[e];if(!g)return null;b.renderedIds[d]=!0;var h=c._componentInstances[d];h||(g.constructor.prototype.$context=c._getComponentContext(g,a),h=new g.constructor(c._serviceLocator),h.$context=g.constructor.prototype.$context,c._componentInstances[d]=h);var i={name:e,context:h.$context};c._componentElements[d]=a;var j=hrTimeHelper.get();return c._eventBus.emit('componentRender',i),Promise.resolve().then(function(){return d in b.rootIds&&f?c._unbindAll(a,b):[]}).catch(function(a){return c._eventBus.emit('error',a)}).then(function(){var a=moduleHelper.getMethodToInvoke(h,'render');return moduleHelper.getSafePromise(a)}).catch(function(b){return c._handleRenderError(a,g,b)}).then(function(d){var e=a.tagName===TAG_NAMES.HEAD;if(''===d&&e)return[];var f=a.cloneNode(!1);if(f.innerHTML=d,e)return c._mergeHead(a,f),[];morphdom(a,f,{onBeforeElChildrenUpdated:function onBeforeElChildrenUpdated(d){return d===a||!c._isComponentElement(b.components,d)}});var g=c._findNestedComponents(a,b.components).map(function(a){return c.renderComponent(a,b)});return Promise.all(g)}).then(function(){return i.hrTime=hrTimeHelper.get(j),i.time=hrTimeHelper.toMilliseconds(i.hrTime),c._eventBus.emit('componentRendered',i),c._bindComponent(a)}).then(function(){d in b.rootIds&&f&&c._collectRenderingGarbage(b)}).catch(function(a){return c._eventBus.emit('error',a)})})}},{key:'getComponentById',value:function getComponentById(a){var b=this._window.document.getElementById(a);return this.getComponentByElement(b)}},{key:'queryComponentSelector',value:function queryComponentSelector(a,b){var c=this._isComponentObject(b)?b.$context.element:this._window.document;return this.getComponentByElement(c.querySelector(a))}},{key:'queryComponentSelectorAll',value:function queryComponentSelectorAll(a,b){var c=this._isComponentObject(b)?b.$context.element:this._window.document;return this._mapElementsToComponents(c.querySelectorAll(a))}},{key:'getComponentsByTagName',value:function getComponentsByTagName(a,b){var c=this._isComponentObject(b)?b.$context.element:this._window.document;return this._mapElementsToComponents(c.getElementsByTagName(a))}},{key:'getComponentsByClassName',value:function getComponentsByClassName(a,b){var c=this._isComponentObject(b)?b.$context.element:this._window.document;return this._mapElementsToComponents(c.getElementsByClassName(a))}},{key:'getComponentByElement',value:function getComponentByElement(a){if(!a)return null;var b=a[moduleHelper.COMPONENT_ID];return b?this._componentInstances[b]||null:null}},{key:'collectGarbage',value:function collectGarbage(){var a=this;return this._getPromiseForReadyState().then(function(){var b={roots:[],components:a._componentLoader.getComponentsByNames()};return Object.keys(a._componentElements).forEach(function(c){if(!SPECIAL_IDS.hasOwnProperty(c))for(var d=a._componentElements[c];d!==a._window.document.documentElement;){if(null===d.parentElement){b.roots.push(d);break}if(a._isComponentElement(b.components,d.parentElement))break;d=d.parentElement}}),a._removeDetachedComponents(b)})}},{key:'createComponent',value:function createComponent(a,b){var c=this;return'string'==typeof a?(b=b||Object.create(null),this._getPromiseForReadyState().then(function(){var d=c._componentLoader.getComponentsByNames(),e=moduleHelper.getOriginalComponentName(a);if(moduleHelper.isHeadComponent(e)||moduleHelper.isDocumentComponent(e)||!(e in d))return Promise.reject(new Error('Component for tag "'+a+'" not found'));var f=moduleHelper.getTagNameForComponentName(e),g=c._window.document.createElement(f);return Object.keys(b).forEach(function(a){return g.setAttribute(a,b[a])}),c.renderComponent(g).then(function(){return g})})):Promise.reject(new Error('The tag name must be a string'))}},{key:'_collectRenderingGarbage',value:function _collectRenderingGarbage(a){var b=this;Object.keys(a.unboundIds).forEach(function(c){c in a.renderedIds||b._removeComponentById(c)})}},{key:'_removeDetachedComponents',value:function _removeDetachedComponents(a){var b=this;if(0===a.roots.length)return Promise.resolve();var c=a.roots.pop();return this._traverseComponents([c],a.components,function(a){return b._removeDetachedComponent(a)}).then(function(){return b._removeDetachedComponents(a)})}},{key:'_removeDetachedComponent',value:function _removeDetachedComponent(a){var b=this,c=this._getId(a);return this._unbindComponent(a).then(function(){return b._removeComponentById(c)})}},{key:'_unbindAll',value:function _unbindAll(a,b){var c=this;return this._traverseComponents([a],b.components,function action(a){var d=c._getId(a);return b.unboundIds[d]=!0,c._unbindComponent(a)})}},{key:'_unbindComponent',value:function _unbindComponent(a){var b=this,c=this._getId(a),d=this._componentInstances[c];if(!d)return Promise.resolve();c in this._componentBindings&&(Object.keys(this._componentBindings[c]).forEach(function(d){a.removeEventListener(d,b._componentBindings[c][d].handler,NON_BUBBLING_EVENTS.hasOwnProperty(d))}),delete this._componentBindings[c]);var e=moduleHelper.getMethodToInvoke(d,'unbind');return moduleHelper.getSafePromise(e).then(function(){b._eventBus.emit('componentUnbound',{element:a,id:a.id||null})}).catch(function(a){return b._eventBus.emit('error',a)})}},{key:'_removeComponentById',value:function _removeComponentById(a){delete this._componentElements[a],delete this._componentInstances[a],delete this._componentBindings[a]}},{key:'_bindComponent',value:function _bindComponent(a){var b=this,c=this._getId(a),d=this._componentInstances[c];if(!d)return Promise.resolve();var e=moduleHelper.getMethodToInvoke(d,'bind');return moduleHelper.getSafePromise(e).then(function(e){return e&&'object'===('undefined'==typeof e?'undefined':_typeof(e))?void(b._componentBindings[c]=Object.create(null),Object.keys(e).forEach(function(f){if(f=f.toLowerCase(),!(f in b._componentBindings[c])){var g=Object.create(null);Object.keys(e[f]).forEach(function(a){var b=e[f][a];'function'!=typeof b||(g[a]=b.bind(d))}),b._componentBindings[c][f]={handler:b._createBindingHandler(a,g),selectorHandlers:g},a.addEventListener(f,b._componentBindings[c][f].handler,NON_BUBBLING_EVENTS.hasOwnProperty(f))}}),b._eventBus.emit('componentBound',{element:a,id:a.id||null})):void b._eventBus.emit('componentBound',{element:a,id:a.id||null})})}},{key:'_createBindingHandler',value:function _createBindingHandler(a,b){var c=this,d=Object.keys(b);return function(e){var f=e.target,g=createCustomEvent(e,function(){return f}),h=c._getMatchesMethod(f),i=d.some(function(a){return!!h(a)&&(b[a](g),!0)});if(!i&&e.bubbles)for(;f.parentNode&&f!==a&&(f=f.parentNode,h=c._getMatchesMethod(f),i=c._tryDispatchEvent(d,h,b,g),!i););}}},{key:'_tryDispatchEvent',value:function _tryDispatchEvent(a,b,c,d){return a.some(function(a){return!!b(a)&&(c[a](d),!0)})}},{key:'_isComponentElement',value:function _isComponentElement(a,b){return!!moduleHelper.isComponentNode(b)&&moduleHelper.getOriginalComponentName(b.nodeName)in a}},{key:'_isComponentObject',value:function _isComponentObject(a){return a&&a.$context&&'object'===_typeof(a.$context)&&a.$context.element instanceof this._window.Element}},{key:'_mapElementsToComponents',value:function _mapElementsToComponents(a){var b=this,c=[];return Array.prototype.forEach.call(a,function(a){var d=b.getComponentByElement(a);d&&c.push(d)}),c}},{key:'_traverseComponents',value:function _traverseComponents(a,b,c){if(0===a.length)return Promise.resolve();var d=a.shift();return a=a.concat(this._findNestedComponents(d,b)),this._traverseComponents(a,b,c).then(function(){return c(d)})}},{key:'_findNestedComponents',value:function _findNestedComponents(a,b){for(var c,d=this,e=[],f=[a];0<f.length;)c=f.shift().children,c&&Array.prototype.forEach.call(c,function(a){return d._isComponentElement(b,a)?void e.push(a):void f.push(a)});return e}},{key:'_handleRenderError',value:function _handleRenderError(a,b,c){var d=this;return this._eventBus.emit('error',c),Promise.resolve().then(function(){return a.tagName===TAG_NAMES.HEAD?'':!d._config.isRelease&&c instanceof Error?errorHelper.prettyPrint(c,d._window.navigator.userAgent):''}).catch(function(){return''})}},{key:'_updateStoreComponents',value:function _updateStoreComponents(){var a=this;if(this._isUpdating)return Promise.resolve();var b=this._window.document.documentElement.getAttribute(moduleHelper.ATTRIBUTE_STORE);if(b in this._currentChangedStores){var h=this._currentRoutingContext.location.toString();return h===this._window.location.toString()?(this._window.location.reload(),Promise.resolve()):(this._window.location.assign(h),Promise.resolve())}if(this._isUpdating=!0,this._awaitingRouting){var c=this._componentLoader.getComponentsByNames(),d=this._storeDispatcher.setState(this._awaitingRouting.state,this._awaitingRouting.routingContext);d.forEach(function(b){a._currentChangedStores[b]=!0}),this._currentRoutingContext=this._awaitingRouting.routingContext,Object.keys(this._componentInstances).forEach(function(b){var d=a._componentInstances[b];d.$context=a._getComponentContext(c[d.$context.name],d.$context.element)}),this._awaitingRouting=null}var e=Object.keys(this._currentChangedStores);if(0===e.length)return this._isUpdating=!1,Promise.resolve();this._currentChangedStores=Object.create(null);var f=this._createRenderingContext(e),g=f.roots.map(function(b){return f.rootIds[a._getId(b)]=!0,a.renderComponent(b,f)});return Promise.all(g).catch(function(b){return a._eventBus.emit('error',b)}).then(function(){return a._isUpdating=!1,a._eventBus.emit('documentUpdated',e),a._updateStoreComponents()})}},{key:'_mergeHead',value:function _mergeHead(a,b){if(b){for(var c,d=Object.create(null),e=0;e<a.childNodes.length;e++){if(c=a.childNodes[e],!isTagImmutable(c)){a.removeChild(c),e--;continue}d[this._getElementKey(c)]=!0}for(var f,g=0;g<b.children.length;g++)(f=b.children[g],!(this._getElementKey(f)in d))&&(a.appendChild(f),g--)}}},{key:'_getElementKey',value:function _getElementKey(a){var b=[];switch(a.nodeName){case TAG_NAMES.LINK:b.push('href='+a.getAttribute('href'));break;case TAG_NAMES.SCRIPT:b.push('src='+a.getAttribute('src'));}return'<'+a.nodeName+' '+b.sort().join(' ')+'>'+a.textContent+'</'+a.nodeName+'>'}},{key:'_initializeComponent',value:function _initializeComponent(a,b){var c=this;return Promise.resolve().then(function(){var d=moduleHelper.getOriginalComponentName(a.nodeName);if(!(d in b))return null;var e=c._getId(a),f=b[d].constructor;f.prototype.$context=c._getComponentContext(b[d],a);var g=new f(c._serviceLocator);return g.$context=f.prototype.$context,c._componentElements[e]=a,c._componentInstances[e]=g,c._storeDispatcher.getStore(a.getAttribute(moduleHelper.ATTRIBUTE_STORE)),c._eventBus.emit('componentRendered',{name:d,attributes:g.$context.attributes,context:g.$context}),c._bindComponent(a)})}},{key:'_getComponentContext',value:function _getComponentContext(a,b){var c=this,d=b.getAttribute(moduleHelper.ATTRIBUTE_STORE),e=Object.create(this._currentRoutingContext);return this._storeDispatcher.getStore(d),Object.defineProperties(e,{name:{get:function get(){return a.name},enumerable:!0},attributes:{get:function get(){return attributesToObject(b.attributes)},enumerable:!0}}),e.element=b,e.getComponentById=function(a){return c.getComponentById(a)},e.getComponentByElement=function(a){return c.getComponentByElement(a)},e.getComponentsByTagName=function(a,b){return c.getComponentsByTagName(a,b)},e.getComponentsByClassName=function(a,b){return c.getComponentsByClassName(a,b)},e.queryComponentSelector=function(a,b){return c.queryComponentSelector(a,b)},e.queryComponentSelectorAll=function(a,b){return c.queryComponentSelectorAll(a,b)},e.createComponent=function(a,b){return c.createComponent(a,b)},e.collectGarbage=function(){return c.collectGarbage()},e.getStoreData=function(){var a=b.getAttribute(moduleHelper.ATTRIBUTE_STORE);return c._storeDispatcher.getStoreData(a)},e.sendAction=function(a,d){var e=b.getAttribute(moduleHelper.ATTRIBUTE_STORE);return c._storeDispatcher.sendAction(e,a,d)},Object.freeze(e)}},{key:'_findRenderingRoots',value:function _findRenderingRoots(a){var b=this,c=this._window.document.head.getAttribute(moduleHelper.ATTRIBUTE_STORE),d=this._componentLoader.getComponentsByNames(),e=Object.create(null),f=Object.create(null),g=Object.create(null),h=[];return a.forEach(function(a){f[a]=!0;var c=b._window.document.querySelectorAll('['+moduleHelper.ATTRIBUTE_STORE+'="'+a+'"]');0===c.length||(e[a]=c)}),c in f&&moduleHelper.HEAD_COMPONENT_NAME in d&&(g[this._getId(this._window.document.head)]=!0,h.push(this._window.document.head)),a.forEach(function(a){if(a in e){var c=Object.create(null);Array.prototype.forEach.call(e[a],function(a){if(moduleHelper.isComponentNode(a)){var e=a,i=e,j=b._getId(a);if(!(j in c)){for(c[j]=!0;e.parentElement;){e=e.parentElement;var m=b._getId(e);if(m in c)return;var k=e.getAttribute(moduleHelper.ATTRIBUTE_STORE),l=moduleHelper.getOriginalComponentName(e.tagName);k&&k in f&&l in d&&(i=e,j=m)}j in g||(g[j]=!0,h.push(i))}}})}}),h}},{key:'_createRenderingContext',value:function _createRenderingContext(a){var b=this._componentLoader.getComponentsByNames();return{config:this._config,renderedIds:Object.create(null),unboundIds:Object.create(null),isHeadRendered:!1,bindMethods:[],routingContext:this._currentRoutingContext,components:b,rootIds:Object.create(null),roots:a?this._findRenderingRoots(a):[]}}},{key:'_getId',value:function _getId(a){if(a===this._window.document.documentElement)return SPECIAL_IDS.$$document;if(a===this._window.document.head)return SPECIAL_IDS.$$head;if(!a[moduleHelper.COMPONENT_ID])for(a[moduleHelper.COMPONENT_ID]=uuid.v4();a[moduleHelper.COMPONENT_ID]in this._componentInstances;)a[moduleHelper.COMPONENT_ID]=uuid.v4();return a[moduleHelper.COMPONENT_ID]}},{key:'_getMatchesMethod',value:function _getMatchesMethod(a){var b=this,c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector||function(c){return matches(b._window,a,c)};return c.bind(a)}}]),b}(DocumentRendererBase);function attributesToObject(a){var b=Object.create(null);return Array.prototype.forEach.call(a,function(a){b[a.name]=a.value}),b}function matches(a,b,c){var d=b.document||b.ownerDocument||a.document,e=d.querySelectorAll(c);return Array.prototype.some.call(e,function(a){return a===b})}function createCustomEvent(a,b){var c=Object.create(a),d=[],e={};for(var f in a)d.push(f);return d.forEach(function(b){return'function'==typeof a[b]?void(e[b]={get:function get(){return a[b].bind(a)}}):void(e[b]={get:function get(){return a[b]},set:function set(c){a[b]=c}})}),e.currentTarget={get:b},Object.defineProperties(c,e),Object.seal(c),Object.freeze(c),c}function isTagImmutable(a){return a.nodeName===TAG_NAMES.SCRIPT||a.nodeName===TAG_NAMES.STYLE||a.nodeName===TAG_NAMES.LINK&&'stylesheet'===a.getAttribute('rel')}module.exports=DocumentRenderer;

},{"../lib/base/DocumentRendererBase":31,"../lib/helpers/errorHelper":35,"../lib/helpers/hrTimeHelper":20,"../lib/helpers/moduleHelper":36,"morphdom":41,"uuid":52}],19:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var URI=require('catberry-uri').URI,MOUSE_PRIMARY_KEY=0,HREF_ATTRIBUTE_NAME='href',TARGET_ATTRIBUTE_NAME='target',A_TAG_NAME='A',BODY_TAG_NAME='BODY',RequestRouter=function(){function a(b){var c=this;_classCallCheck(this,a),this._eventBus=b.resolve('eventBus'),this._window=b.resolve('window'),this._documentRenderer=b.resolve('documentRenderer'),this._stateProvider=b.resolve('stateProvider'),this._contextFactory=b.resolve('contextFactory'),this._isHistorySupported=this._window.history&&this._window.history.pushState instanceof Function,this._wrapDocument(),this._location=new URI(this._window.location.toString()),this._state=this._stateProvider.getStateByUri(this._location),this._isStateInitialized=!1,this._referrer='',this._changeState(this._state).catch(function(a){return c._handleError(a)})}return _createClass(a,[{key:'go',value:function go(a,b){try{var c=new URI(a).resolveRelative(this._location),d=c.toString(),e=this._location.authority?this._location.authority.toString():null,f=c.authority?c.authority.toString():null;if(!this._isHistorySupported||c.scheme!==this._location.scheme||f!==e)return this._window.location.assign(d),Promise.resolve();var g=c.query?c.query.toString():null,h=this._location.query?this._location.query.toString():null;if(c.path===this._location.path&&g===h)return this._location=c,this._window.location.hash=this._location.fragment||'',Promise.resolve();var i=this._stateProvider.getStateByUri(c);return i?(this._state=i,this._referrer=this._location,this._location=c,b||this._window.history.pushState(i,'',d),this._changeState(i)):(this._window.location.assign(d),Promise.resolve())}catch(a){return Promise.reject(a)}}},{key:'_changeState',value:function _changeState(a){var b=this;return Promise.resolve().then(function(){if(null===a)return b._window.location.reload(),null;var c=b._contextFactory.create({referrer:b._referrer||b._window.document.referrer,location:b._location,userAgent:b._window.navigator.userAgent});return b._isStateInitialized?b._documentRenderer.render(a,c):(b._isStateInitialized=!0,b._documentRenderer.initWithState(a,c))})}},{key:'_wrapDocument',value:function _wrapDocument(){var a=this;this._isHistorySupported&&(this._window.addEventListener('popstate',function(){return Promise.resolve().then(function(){return a.go(a._window.location.toString(),!0)}).catch(function(b){return a._handleError(b)})}),this._window.document.body.addEventListener('click',function(b){if(!b.defaultPrevented)if(b.target.tagName===A_TAG_NAME)a._linkClickHandler(b,b.target);else{var c=closestLink(b.target);if(!c)return;a._linkClickHandler(b,c)}}))}},{key:'_linkClickHandler',value:function _linkClickHandler(a,b){var c=this,d=b.getAttribute(TARGET_ATTRIBUTE_NAME);if(!d&&!(a.button!==MOUSE_PRIMARY_KEY||a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)){var e=b.getAttribute(HREF_ATTRIBUTE_NAME);e&&(a.preventDefault(),this.go(e).catch(function(a){return c._handleError(a)}))}}},{key:'_handleError',value:function _handleError(a){this._eventBus.emit('error',a)}}]),a}();function closestLink(a){for(;a&&a.nodeName!==A_TAG_NAME&&a.nodeName!==BODY_TAG_NAME;)a=a.parentNode;return a&&a.nodeName===A_TAG_NAME?a:null}module.exports=RequestRouter;

},{"catberry-uri":9}],20:[function(require,module,exports){
'use strict';module.exports={get:require('browser-process-hrtime'),toMessage:require('pretty-hrtime'),toMilliseconds:function toMilliseconds(a){return 1e3*a[0]+Math.round(a[1]/1e6)}};

},{"browser-process-hrtime":3,"pretty-hrtime":42}],21:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var templateHelper=require('../../lib/helpers/templateHelper'),LoaderBase=require('../../lib/base/LoaderBase'),ComponentLoader=function(a){function b(a){_classCallCheck(this,b);var c;try{c=a.resolveAll('componentTransform')}catch(a){c=[]}var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d._serviceLocator=a,d._eventBus=a.resolve('eventBus'),d._loadedComponents=null,d}return _inherits(b,a),_createClass(b,[{key:'load',value:function load(){var a=this;return this._loadedComponents?Promise.resolve(this._loadedComponents):(this._loadedComponents=Object.create(null),Promise.resolve().then(function(){return a._serviceLocator.resolveAll('component')}).catch(function(){return[]}).then(function(b){var c=[];return b.forEach(function(b){b&&'object'===('undefined'==typeof b?'undefined':_typeof(b))&&c.unshift(a._processComponent(b))}),Promise.all(c)}).then(function(b){return b.forEach(function(b){b&&(a._loadedComponents[b.name]=b)}),a._eventBus.emit('allComponentsLoaded',b),a._loadedComponents}))}},{key:'_processComponent',value:function _processComponent(a){var b=this,c=Object.create(a);return this._applyTransforms(c).then(function(d){if(!d)throw new Error('Transformation for the "'+a.name+'" component returned a bad result');return c=Object.create(d),templateHelper.registerTemplates(c),b._eventBus.emit('componentLoaded',c),c}).catch(function(a){return b._eventBus.emit('error',a),null})}},{key:'getComponentsByNames',value:function getComponentsByNames(){return this._loadedComponents||Object.create(null)}}]),b}(LoaderBase);module.exports=ComponentLoader;

},{"../../lib/base/LoaderBase":32,"../../lib/helpers/templateHelper":38}],22:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var LoaderBase=require('../../lib/base/LoaderBase'),StoreLoader=function(a){function b(a){_classCallCheck(this,b);var c;try{c=a.resolveAll('storeTransform')}catch(a){c=[]}var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d._serviceLocator=a,d._eventBus=a.resolve('eventBus'),d._loadedStores=null,d}return _inherits(b,a),_createClass(b,[{key:'load',value:function load(){var a=this;return this._loadedStores?Promise.resolve(this._loadedStores):(this._loadedStores=Object.create(null),Promise.resolve().then(function(){return a._serviceLocator.resolveAll('store')}).catch(function(){return[]}).then(function(b){var c=[];return b.forEach(function(b){b&&'object'===('undefined'==typeof b?'undefined':_typeof(b))&&c.unshift(a._getStore(b))}),Promise.all(c)}).then(function(b){return b.forEach(function(b){b&&(a._loadedStores[b.name]=b)}),a._eventBus.emit('allStoresLoaded',a._loadedStores),Promise.resolve(a._loadedStores)}))}},{key:'_getStore',value:function _getStore(a){var b=this;return this._applyTransforms(a).then(function(c){if(!c)throw new Error('Transformation for the "'+a.name+'" store returned a bad result');return b._eventBus.emit('storeLoaded',c),c}).catch(function(a){return b._eventBus.emit('error',a),null})}},{key:'getStoresByNames',value:function getStoresByNames(){return this._loadedStores||Object.create(null)}}]),b}(LoaderBase);module.exports=StoreLoader;

},{"../../lib/base/LoaderBase":32}],23:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var propertyHelper=require('../../lib/helpers/propertyHelper'),ModuleApiProviderBase=require('../../lib/base/ModuleApiProviderBase'),ModuleApiProvider=function(a){function b(a){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a))}return _inherits(b,a),_createClass(b,[{key:'notFound',value:function notFound(){var a=this.locator.resolve('window');return a.location.reload(),Promise.resolve()}},{key:'redirect',value:function redirect(a){var b=this.locator.resolve('requestRouter');return b.go(a)}},{key:'clearFragment',value:function clearFragment(){var a=this.locator.resolve('window'),b=a.document.body.scrollTop;return a.location.hash='',a.document.body.scrollTop=b,Promise.resolve()}},{key:'isBrowser',get:function get(){return!0}},{key:'isServer',get:function get(){return!1}}]),b}(ModuleApiProviderBase);module.exports=ModuleApiProvider;

},{"../../lib/base/ModuleApiProviderBase":33,"../../lib/helpers/propertyHelper":37}],24:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var StateProviderBase=require('../../lib/base/StateProviderBase'),StateProvider=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:'_getRouteDescriptors',value:function _getRouteDescriptors(a){var b=[],c=void 0;try{c=a.resolveAll('routeDefinition')}catch(a){c=[]}var d=Object.create(null);try{a.resolveAll('routeDescriptor').forEach(function(a){d[a.expression]=a})}catch(a){}return c.forEach(function(a){if('string'==typeof a)return void b.push(d[a]);if('object'===('undefined'==typeof a?'undefined':_typeof(a))&&'string'==typeof a.expression){var c=d[a.expression];return'string'==typeof a.name&&(c.name=a.name),a.map instanceof Function&&(c.map=a.map),void b.push(c)}'object'===('undefined'==typeof a?'undefined':_typeof(a))&&a.expression instanceof RegExp&&a.map instanceof Function&&b.push(a)}),b}}]),b}(StateProviderBase);module.exports=StateProvider;

},{"../../lib/base/StateProviderBase":34}],25:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var propertyHelper=require('./helpers/propertyHelper'),ContextFactory=function(){function a(b){_classCallCheck(this,a),this._serviceLocator=b}return _createClass(a,[{key:'create',value:function create(a){var b=this._serviceLocator.resolve('moduleApiProvider'),c=Object.create(b);return Object.keys(a).forEach(function(b){return propertyHelper.defineReadOnly(c,b,a[b])}),c}}]),a}();module.exports=ContextFactory;

},{"./helpers/propertyHelper":37}],26:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var events=require('events'),SerialWrapper=function(){function a(){_classCallCheck(this,a),this._emitter=new events.EventEmitter,this._emitter.setMaxListeners(0),this._toInvoke=Object.create(null),this._inProgress=Object.create(null)}return _createClass(a,[{key:'add',value:function add(a,b){this._toInvoke[a]=b}},{key:'isRegistered',value:function isRegistered(a){return'function'==typeof this._toInvoke[a]}},{key:'invoke',value:function invoke(a){var b=this;return this.isRegistered(a)?this._inProgress[a]?new Promise(function(c,d){b._emitter.once(a,c),b._emitter.once(a+'--error',d)}):(this._inProgress[a]=!0,this._toInvoke[a]().then(function(c){b._emitter.emit(a,c),b._inProgress[a]=null}).catch(function(c){b._emitter.emit(a+'--error',c),b._inProgress[a]=null}),this.invoke(a)):Promise.reject(new Error('There is no such registered method'))}}]),a}();module.exports=SerialWrapper;

},{"events":40}],27:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var SerialWrapper=require('./SerialWrapper'),moduleHelper=require('./helpers/moduleHelper'),propertyHelper=require('./helpers/propertyHelper'),DEFAULT_LIFETIME=6e4,StoreDispatcher=function(){function a(b){_classCallCheck(this,a),this._serviceLocator=b,this._storeLoader=b.resolve('storeLoader'),this._eventBus=b.resolve('eventBus'),this._storeInstances=Object.create(null),this._lastData=Object.create(null),this._lastState=null,this._dependants=Object.create(null),this._serialWrapper=new SerialWrapper,this._currentBasicContext=null}return _createClass(a,[{key:'getStoreData',value:function getStoreData(a){var b=this;if(!this._lastState)return this._errorState();if('string'!=typeof a)return Promise.resolve(null);if(a in this._lastData){var e=Date.now()-this._lastData[a].createdAt;if(e<=this._lastData[a].lifetime)return Promise.resolve(this._lastData[a].data);delete this._lastData[a]}this._eventBus.emit('storeDataLoad',{name:a});var c=this.getStore(a);if(!c)return this._errorStoreNotFound(a);var d='number'==typeof c.$lifetime?c.$lifetime:DEFAULT_LIFETIME;return this._serialWrapper.invoke(a).then(function(c){return b._lastData[a]={data:c,lifetime:d,createdAt:Date.now()},b._eventBus.emit('storeDataLoaded',{name:a,data:c,lifetime:d}),c})}},{key:'sendAction',value:function sendAction(a,b,c){var d=this;if(!this._lastState)return this._errorState();var e={storeName:a,actionName:b,args:c};this._eventBus.emit('actionSend',e);var f=this.getStore(a);if(!f)return this._errorStoreNotFound(a);var g=moduleHelper.getMethodToInvoke(f,'handle',b);return moduleHelper.getSafePromise(function(){return g(c)}).then(function(a){return d._eventBus.emit('actionSent',e),a})}},{key:'setState',value:function setState(a,b){var c=this;a=a||Object.create(null);var d=this._storeLoader.getStoresByNames(),e=Object.keys(a);if(e.forEach(function(a){a in d||c._eventBus.emit('warn','Store "'+a+'" does not exist (might be a typo in a route)')}),!this._lastState)return this._currentBasicContext=b,this._lastState=a,[];var f=Object.create(null);Object.keys(this._lastState).filter(function(b){return!(b in a)}).forEach(function(a){f[a]=!0}),e.forEach(function(b){if(!(b in c._lastState))return void(f[b]=!0);var d=Object.keys(c._lastState[b]),e=Object.keys(a[b]);return e.length===d.length?void e.every(function(d){return a[b][d]===c._lastState[b][d]||(f[b]=!0,!1)}):void(f[b]=!0)}),this._lastState=a,this._currentBasicContext!==b&&(this._currentBasicContext=b,Object.keys(this._storeInstances).forEach(function(a){c._storeInstances[a].$context=c._getStoreContext(a)}));var g=Object.create(null);return Object.keys(f).forEach(function(a){var b=c.getStore(a);b&&b.$context.changed().forEach(function(a){g[a]=!0})}),this._eventBus.emit('stateChanged',{oldState:this._lastState,newState:a}),Object.keys(g)}},{key:'_getStoreContext',value:function _getStoreContext(a){var b=this,c=Object.create(this._currentBasicContext);return propertyHelper.defineReadOnly(c,'name',a),propertyHelper.defineReadOnly(c,'state',this._lastState[a]||Object.create(null)),c.changed=function(){for(var c,d=Object.create(null),e=[a];0<e.length;)c=e.shift(),c in d||(d[c]=!0,c in b._dependants&&(e=e.concat(Object.keys(b._dependants[c]))),delete b._lastData[c],b._eventBus.emit('storeChanged',c));return Object.keys(d)},c.getStoreData=function(c){return c===a?Promise.resolve(null):b.getStoreData(c)},c.setDependency=function(c){c in b._dependants||(b._dependants[c]=Object.create(null)),b._dependants[c][a]=!0},c.unsetDependency=function(c){c in b._dependants&&delete b._dependants[c][a]},c.sendAction=function(a,c,d){return b.sendAction(a,c,d)},c}},{key:'getStore',value:function getStore(a){var b=this;if(!a)return null;var c=this._storeInstances[a];if(c)return c;var d=this._storeLoader.getStoresByNames(),e=this._serviceLocator.resolve('config');if(!(a in d))return null;var f=d[a].constructor;return f.prototype.$context=this._getStoreContext(a),this._storeInstances[a]=new f(this._serviceLocator),this._storeInstances[a].$context=f.prototype.$context,this._serialWrapper.add(a,function(){var c=moduleHelper.getMethodToInvoke(b._storeInstances[a],'load');return moduleHelper.getSafePromise(c)}),this._storeInstances[a]}},{key:'_errorStoreNotFound',value:function _errorStoreNotFound(a){return Promise.reject(new Error('Store "'+a+'" not found'))}},{key:'_errorState',value:function _errorState(){return Promise.reject(new Error('State should be set before any request'))}}]),a}();module.exports=StoreDispatcher;

},{"./SerialWrapper":26,"./helpers/moduleHelper":36,"./helpers/propertyHelper":37}],28:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var moduleHelper=require('../helpers/moduleHelper'),StateProvider=require('../providers/StateProvider'),StoreLoader=require('../loaders/StoreLoader'),ComponentLoader=require('../loaders/ComponentLoader'),DocumentRenderer=require('../DocumentRenderer'),RequestRouter=require('../RequestRouter'),ModuleApiProviderBase=require('../base/ModuleApiProviderBase'),ContextFactory=require('../ContextFactory'),EventEmitter=require('events').EventEmitter,BootstrapperBase=function(){function a(b){_classCallCheck(this,a),this._catberryConstructor=b}return _createClass(a,[{key:'create',value:function create(a){var b=new this._catberryConstructor;return this.configure(a||{},b.locator),b.events=new ModuleApiProviderBase(b.locator),b}},{key:'configure',value:function configure(a,b){var c=new EventEmitter;c.setMaxListeners(0),b.registerInstance('eventBus',c),b.registerInstance('config',a),b.register('stateProvider',StateProvider,!0),b.register('contextFactory',ContextFactory,!0),b.register('storeLoader',StoreLoader,!0),b.register('componentLoader',ComponentLoader,!0),b.register('documentRenderer',DocumentRenderer,!0),b.register('requestRouter',RequestRouter,!0)}}]),a}();module.exports=BootstrapperBase;

},{"../ContextFactory":25,"../DocumentRenderer":18,"../RequestRouter":19,"../base/ModuleApiProviderBase":33,"../helpers/moduleHelper":36,"../loaders/ComponentLoader":21,"../loaders/StoreLoader":22,"../providers/StateProvider":24,"events":40}],29:[function(require,module,exports){
'use strict';function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var ServiceLocator=require('catberry-locator'),CatberryBase=function a(){_classCallCheck(this,a),this.locator=new ServiceLocator,this.version='9.0.0',this.events=null,this.locator.registerInstance('serviceLocator',this.locator),this.locator.registerInstance('catberry',this)};module.exports=CatberryBase;

},{"catberry-locator":4}],30:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var CookieWrapperBase=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:'getAll',value:function getAll(){var a=this.getCookieString();return this._parseCookieString(a)}},{key:'get',value:function get(a){return'string'==typeof a?this.getAll()[a]||'':''}},{key:'_parseCookieString',value:function _parseCookieString(a){var b=Object.create(null);return'string'==typeof a?(a.split(/; */).forEach(function(a){var c=a.indexOf('=');if(!(0>c)){var d=a.substring(0,c).trim();b[d]=a.substring(c+1).trim().replace(/^"|"$/g,'')}}),b):b}},{key:'_convertToCookieSetup',value:function _convertToCookieSetup(a){if('string'!=typeof a.key||'string'!=typeof a.value)throw new Error('Wrong key or value');var b=a.key+'='+a.value;return'number'==typeof a.maxAge&&(b+='; Max-Age='+a.maxAge.toFixed(),!a.expires&&(a.expires=new Date(Date.now()+1e3*a.maxAge))),a.expires instanceof Date&&(b+='; Expires='+a.expires.toUTCString()),'string'==typeof a.path&&(b+='; Path='+a.path),'string'==typeof a.domain&&(b+='; Domain='+a.domain),'boolean'==typeof a.secure&&a.secure&&(b+='; Secure'),'boolean'==typeof a.httpOnly&&a.httpOnly&&(b+='; HttpOnly'),b}}]),a}();module.exports=CookieWrapperBase;

},{}],31:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var DocumentRendererBase=function(){function a(b){var c=this;_classCallCheck(this,a),this._serviceLocator=b,this._contextFactory=b.resolve('contextFactory'),this._componentLoader=b.resolve('componentLoader'),this._eventBus=b.resolve('eventBus');var d=b.resolve('storeLoader');this._loading=Promise.all([this._componentLoader.load(),d.load()]).then(function(){c._loading=null,c._eventBus.emit('ready')}).catch(function(a){return c._eventBus.emit('error',a)})}return _createClass(a,[{key:'_getPromiseForReadyState',value:function _getPromiseForReadyState(){return this._loading?this._loading:Promise.resolve()}}]),a}();module.exports=DocumentRendererBase;

},{}],32:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var LoaderBase=function(){function a(b,c){_classCallCheck(this,a),this._transforms=c,this._eventBus=b.resolve('eventBus')}return _createClass(a,[{key:'_applyTransforms',value:function _applyTransforms(a,b){var c=this;if(void 0===b&&(b=this._transforms.length-1),0>b)return Promise.resolve(a);var d=this._transforms[b];return Promise.resolve().then(function(){return d.transform(a)}).catch(function(b){return c._eventBus.emit('error',b),a}).then(function(a){return c._applyTransforms(a,b-1)})}}]),a}();module.exports=LoaderBase;

},{}],33:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var ModuleApiProviderBase=function(){function a(b){_classCallCheck(this,a),this.locator=b,this.cookie=b.resolve('cookieWrapper'),this._eventBus=b.resolve('eventBus')}return _createClass(a,[{key:'on',value:function on(a,b){return checkEventNameAndHandler(a,b),this._eventBus.on(a,b),this}},{key:'once',value:function once(a,b){return checkEventNameAndHandler(a,b),this._eventBus.once(a,b),this}},{key:'removeListener',value:function removeListener(a,b){return checkEventNameAndHandler(a,b),this._eventBus.removeListener(a,b),this}},{key:'removeAllListeners',value:function removeAllListeners(a){return checkEventNameAndHandler(a,stub),this._eventBus.removeAllListeners(a),this}},{key:'getRouteURI',value:function getRouteURI(a,b){var c=this.locator.resolve('stateProvider');return c.getRouteURI(a,b)}}]),a}();function checkEventNameAndHandler(a,b){if('string'!=typeof a)throw new Error('Event name should be a string');if('function'!=typeof b)throw new Error('Event handler should be a function')}function stub(){}module.exports=ModuleApiProviderBase;

},{}],34:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var uriHelper=require('../helpers/uriHelper'),catberryUri=require('catberry-uri'),URI=catberryUri.URI,StateProviderBase=function(){function a(b){var c=this;_classCallCheck(this,a),this._namedRoutes=Object.create(null),this._routeDescriptors=this._getRouteDescriptors(b),this._routeDescriptors.forEach(function(a){c._restoreRegularExpressions(a),'string'==typeof a.name&&(c._namedRoutes[a.name]=a)}),this._uriMappers=this._getUriMappers()}return _createClass(a,[{key:'getStateByUri',value:function getStateByUri(a){if(0===this._uriMappers.length)return null;a=a.clone(),a.scheme=null,a.authority=null,a.fragment=null,a.path=uriHelper.removeEndSlash(a.path);var b=this._mapState(a);return b?(Object.keys(b).forEach(function(a){return Object.freeze(b[a])}),Object.freeze(b),b):null}},{key:'getRouteURI',value:function getRouteURI(a,b){b=b||Object.create(null);var c=this._namedRoutes[a];if(!c)throw new Error('There is no such route called "'+a+'"');var d=new URI(c.expression);if(0<c.pathParameters.length&&(d.path=setParameterValues(d.path,c.pathParameters,b,function(a,b){return encodeURIComponent(defaultParameterValueProcessor(a,b))})),0<c.queryParameters.length){var e=Object.create(null);c.queryParameters.forEach(function(a){var c=setParameterValues(a.nameExpression,a.nameParameters,b);if(c){if(!a.valueParameters)return void(e[c]=null);if(0===a.valueParameters.length)return void(e[c]=a.valueExpression);var d=a.valueParameters[0].name,f=b[d];if(1===a.valueParameters.length&&Array.isArray(f))return e[c]=[],void f.forEach(function(b){var f=Object.create(null);f[d]=b;var g=setParameterValues(a.valueExpression,a.valueParameters,f);0<g.length&&e[c].push(g)});var g=setParameterValues(a.valueExpression,a.valueParameters,b);0<g.length&&(e[c]=g)}}),0===Object.keys(e).length?d.query=null:d.query.values=e}return d.toString()}},{key:'_mapState',value:function _mapState(a){var b=null;return this._uriMappers.some(function(c){return b=c(a),!!b}),b}},{key:'_getUriMappers',value:function _getUriMappers(){var a=this;return this._routeDescriptors.map(function(b){if(b.expression instanceof RegExp)return function(a){return b.expression.test(a.toString())?b.map(a):null};var c=a._createParameterExtractor(b);return b.map instanceof Function?function(a){var d=c(a);return d?b.map(d):d}:c})}},{key:'_getRouteDescriptors',value:function _getRouteDescriptors(){}},{key:'_restoreRegularExpressions',value:function _restoreRegularExpressions(a){a.pathRegExpSource&&(a.pathRegExp=new RegExp(a.pathRegExpSource,'i')),a.queryParameters&&a.queryParameters.forEach(function(a){a.nameRegExp=new RegExp(a.nameRegExpSource,'i'),a.valueRegExpSource&&(a.valueRegExp=new RegExp(a.valueRegExpSource,'i'))})}},{key:'_createParameterExtractor',value:function _createParameterExtractor(a){var b=new RegExp(a.pathRegExpSource);return function(c){var d=c.path.match(b);if(!d)return null;var e=Object.create(null),f=d.slice(1);return setStateValues(e,f,a.pathParameters),c.query&&c.query.values&&setQueryParameters(e,c.query.values,a),e}}}]),a}();function setStateValues(a,b,c){b.forEach(function(b,d){var e=c[d];e.stores.forEach(function(c){c in a||(a[c]=Object.create(null)),e.name in a[c]?Array.isArray(a[c][e.name])?a[c][e.name].push(b):a[c][e.name]=[a[c][e.name],b]:a[c][e.name]=b})})}function setQueryParameters(a,b,c){Object.keys(b).forEach(function(d){var e=b[d];if(Array.isArray(e))return void e.forEach(function(b){var e=Object.create(null);e[d]=b,setQueryParameters(a,e,c)});var f=null,g=null,h=null;(c.queryParameters.some(function(a){return f=d.match(a.nameRegExp),'string'==typeof e&&a.valueRegExp&&(g=e.match(a.valueRegExp)),!!f&&(h=a,!0)}),!!h)&&(setStateValues(a,f.slice(1),h.nameParameters),g&&setStateValues(a,g.slice(1),h.valueParameters))})}function setParameterValues(a,b,c,d){if(!b||0===b.length)return a;d=d||defaultParameterValueProcessor;for(var e=0,f=b[e],g='',h=0;h<a.length;h++){if(f&&h===f.start){for(g+=d(f,c[f.name]);++h<f.end-1;);e++,f=b[e];continue}g+=a[h]}return g}function defaultParameterValueProcessor(a,b){if(Array.isArray(b))throw new Error('Array value is not supported for the parameter "'+a.name+'"');return b===void 0?'':b+''}module.exports=StateProviderBase;

},{"../helpers/uriHelper":39,"catberry-uri":9}],35:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},ERROR_MESSAGE_REGEXP=/^(?:[\w$]+): (?:.+)\r?\n/i;module.exports={prettyPrint:function prettyPrint(a,b){return a&&'object'===('undefined'==typeof a?'undefined':_typeof(a))?'\n<div style="background-color: white; font-size: 12pt;">\n\t'+new Date().toUTCString()+';<br/>\n\t'+(b||'Unknown browser')+';<br/>\n\tCatberry@9.0.0 (\n\t<a href="https://github.com/catberry/catberry/issues" target="_blank">\n\t\treport an issue\n\t</a>)\n\t<br/><br/>\n\t<span style="color: red; font-size: 16pt; font-weight: bold;">\n\t\t'+escape(a.name)+': '+escape(a.message)+'\n\t</span>\n\t<br/><br/>\n\t'+escape(a.stack).replace(ERROR_MESSAGE_REGEXP,'')+'\n</div>\n':''}};function escape(a){return a=(a||'')+'',a.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\"/g,'&quot;').replace(/\'/g,'&#39;').replace(/\r?\n/g,'<br/>')}

},{}],36:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},helper={ELEMENT_NODE_TYPE:1,COMPONENT_TAG_PREFIX:'CAT-',COMPONENT_ID:'$catberryId',COMPONENT_PREFIX_REGEXP:/^cat-/i,COMPONENT_ERROR_TEMPLATE_POSTFIX:'--error',DOCUMENT_COMPONENT_NAME:'document',DOCUMENT_TAG_NAME:'HTML',HEAD_TAG_NAME:'HEAD',HEAD_COMPONENT_NAME:'head',ATTRIBUTE_STORE:'cat-store',DEFAULT_LOGIC_FILENAME:'index.js',isDocumentComponent:function isDocumentComponent(a){return a.toLowerCase()===helper.DOCUMENT_COMPONENT_NAME},isHeadComponent:function isHeadComponent(a){return a.toLowerCase()===helper.HEAD_COMPONENT_NAME},isComponentNode:function isComponentNode(a){return a.nodeType===helper.ELEMENT_NODE_TYPE&&(helper.COMPONENT_PREFIX_REGEXP.test(a.nodeName)||a.nodeName===helper.HEAD_TAG_NAME||a.nodeName===helper.DOCUMENT_TAG_NAME)},getOriginalComponentName:function getOriginalComponentName(a){return'string'==typeof a?a===helper.DOCUMENT_TAG_NAME?helper.DOCUMENT_COMPONENT_NAME:a===helper.HEAD_TAG_NAME?helper.HEAD_COMPONENT_NAME:a.toLowerCase().replace(helper.COMPONENT_PREFIX_REGEXP,''):''},getTagNameForComponentName:function getTagNameForComponentName(a){if('string'!=typeof a)return'';var b=a.toUpperCase();return a===helper.HEAD_COMPONENT_NAME?b:a===helper.DOCUMENT_COMPONENT_NAME?helper.DOCUMENT_TAG_NAME:helper.COMPONENT_TAG_PREFIX+b},getMethodToInvoke:function getMethodToInvoke(a,b,c){if(!a||'object'!==('undefined'==typeof a?'undefined':_typeof(a)))return defaultPromiseMethod;var d=helper.getCamelCaseName(b,c);return'function'==typeof a[d]?a[d].bind(a):'function'==typeof a[b]?a[b].bind(a,c):defaultPromiseMethod},getCamelCaseName:function getCamelCaseName(a,b){return b?(a&&(b=a+'-'+b),b.replace(/(?:[^a-z0-9]+)(\w)/gi,function(a,b){return b.toUpperCase()}).replace(/(^[^a-z0-9])|([^a-z0-9]$)/gi,'')):''},getSafePromise:function getSafePromise(a){try{return Promise.resolve(a())}catch(a){return Promise.reject(a)}}};function defaultPromiseMethod(){return Promise.resolve()}module.exports=helper;

},{}],37:[function(require,module,exports){
'use strict';module.exports={defineReadOnly:function defineReadOnly(a,b,c){Object.defineProperty(a,b,{enumerable:!1,configurable:!1,writable:!1,value:c})}};

},{}],38:[function(require,module,exports){
'use strict';var helper={registerTemplates:function registerTemplates(a){a.template={render:function render(){return a.render()}}}};module.exports=helper;

},{}],39:[function(require,module,exports){
'use strict';var PATH_END_SLASH_REG_EXP=/(.+)\/($|\?|#)/;module.exports={removeEndSlash:function removeEndSlash(a){return a&&'string'==typeof a?'/'===a?a:a.replace(PATH_END_SLASH_REG_EXP,'$1$2'):''}};

},{}],40:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},objectCreate=Object.create||objectCreatePolyfill,objectKeys=Object.keys||objectKeysPolyfill,bind=Function.prototype.bind||functionBindPolyfill;function EventEmitter(){this._events&&Object.prototype.hasOwnProperty.call(this,'_events')||(this._events=objectCreate(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0;var hasDefineProperty,defaultMaxListeners=10;try{var o={};Object.defineProperty&&Object.defineProperty(o,'x',{value:0}),hasDefineProperty=0===o.x}catch(a){hasDefineProperty=!1}hasDefineProperty?Object.defineProperty(EventEmitter,'defaultMaxListeners',{enumerable:!0,get:function get(){return defaultMaxListeners},set:function set(a){if('number'!=typeof a||0>a||a!==a)throw new TypeError('"defaultMaxListeners" must be a positive number');defaultMaxListeners=a}}):EventEmitter.defaultMaxListeners=defaultMaxListeners,EventEmitter.prototype.setMaxListeners=function(a){if('number'!=typeof a||0>a||isNaN(a))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=a,this};function $getMaxListeners(a){return void 0===a._maxListeners?EventEmitter.defaultMaxListeners:a._maxListeners}EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)};function emitNone(a,b,c){if(b)a.call(c);else for(var d=a.length,e=arrayClone(a,d),f=0;f<d;++f)e[f].call(c)}function emitOne(a,b,c,d){if(b)a.call(c,d);else for(var e=a.length,f=arrayClone(a,e),g=0;g<e;++g)f[g].call(c,d)}function emitTwo(a,b,c,d,e){if(b)a.call(c,d,e);else for(var f=a.length,g=arrayClone(a,f),h=0;h<f;++h)g[h].call(c,d,e)}function emitThree(a,b,c,d,e,f){if(b)a.call(c,d,e,f);else for(var g=a.length,h=arrayClone(a,g),j=0;j<g;++j)h[j].call(c,d,e,f)}function emitMany(a,b,c,d){if(b)a.apply(c,d);else for(var e=a.length,f=arrayClone(a,e),g=0;g<e;++g)f[g].apply(c,d)}EventEmitter.prototype.emit=function(a){var b,c,d,e,f,g,h='error'===a;if(g=this._events,g)h=h&&null==g.error;else if(!h)return!1;if(h){if(1<arguments.length&&(b=arguments[1]),b instanceof Error)throw b;else{var i=new Error('Unhandled "error" event. ('+b+')');throw i.context=b,i}return!1}if(c=g[a],!c)return!1;var j='function'==typeof c;switch(d=arguments.length,d){case 1:emitNone(c,j,this);break;case 2:emitOne(c,j,this,arguments[1]);break;case 3:emitTwo(c,j,this,arguments[1],arguments[2]);break;case 4:emitThree(c,j,this,arguments[1],arguments[2],arguments[3]);break;default:for(e=Array(d-1),f=1;f<d;f++)e[f-1]=arguments[f];emitMany(c,j,this,e);}return!0};function _addListener(a,b,c,d){var e,f,g;if('function'!=typeof c)throw new TypeError('"listener" argument must be a function');if(f=a._events,f?(f.newListener&&(a.emit('newListener',b,c.listener?c.listener:c),f=a._events),g=f[b]):(f=a._events=objectCreate(null),a._eventsCount=0),!g)g=f[b]=c,++a._eventsCount;else if('function'==typeof g?g=f[b]=d?[c,g]:[g,c]:d?g.unshift(c):g.push(c),!g.warned&&(e=$getMaxListeners(a),e&&0<e&&g.length>e)){g.warned=!0;var h=new Error('Possible EventEmitter memory leak detected. '+g.length+' "'+(b+'" listeners added. Use emitter.setMaxListeners() to increase limit.'));h.name='MaxListenersExceededWarning',h.emitter=a,h.type=b,h.count=g.length,'object'===('undefined'==typeof console?'undefined':_typeof(console))&&console.warn&&console.warn('%s: %s',h.name,h.message)}return a}EventEmitter.prototype.addListener=function(a,b){return _addListener(this,a,b,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(a,b){return _addListener(this,a,b,!0)};function onceWrapper(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var a=Array(arguments.length),b=0;b<a.length;++b)a[b]=arguments[b];this.listener.apply(this.target,a);}}function _onceWrap(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=bind.call(onceWrapper,d);return e.listener=c,d.wrapFn=e,e}EventEmitter.prototype.once=function(a,b){if('function'!=typeof b)throw new TypeError('"listener" argument must be a function');return this.on(a,_onceWrap(this,a,b)),this},EventEmitter.prototype.prependOnceListener=function(a,b){if('function'!=typeof b)throw new TypeError('"listener" argument must be a function');return this.prependListener(a,_onceWrap(this,a,b)),this},EventEmitter.prototype.removeListener=function(a,b){var c,d,e,f,g;if('function'!=typeof b)throw new TypeError('"listener" argument must be a function');if(d=this._events,!d)return this;if(c=d[a],!c)return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=objectCreate(null):(delete d[a],d.removeListener&&this.emit('removeListener',a,c.listener||b));else if('function'!=typeof c){for(e=-1,f=c.length-1;0<=f;f--)if(c[f]===b||c[f].listener===b){g=c[f].listener,e=f;break}if(0>e)return this;0===e?c.shift():spliceOne(c,e),1===c.length&&(d[a]=c[0]),d.removeListener&&this.emit('removeListener',a,g||b)}return this},EventEmitter.prototype.removeAllListeners=function(a){var b,c,d;if(c=this._events,!c)return this;if(!c.removeListener)return 0===arguments.length?(this._events=objectCreate(null),this._eventsCount=0):c[a]&&(0==--this._eventsCount?this._events=objectCreate(null):delete c[a]),this;if(0===arguments.length){var e,f=objectKeys(c);for(d=0;d<f.length;++d)e=f[d],'removeListener'===e||this.removeAllListeners(e);return this.removeAllListeners('removeListener'),this._events=objectCreate(null),this._eventsCount=0,this}if(b=c[a],'function'==typeof b)this.removeListener(a,b);else if(b)for(d=b.length-1;0<=d;d--)this.removeListener(a,b[d]);return this};function _listeners(a,b,c){var d=a._events;if(!d)return[];var e=d[b];return e?'function'==typeof e?c?[e.listener||e]:[e]:c?unwrapListeners(e):arrayClone(e,e.length):[]}EventEmitter.prototype.listeners=function(a){return _listeners(this,a,!0)},EventEmitter.prototype.rawListeners=function(a){return _listeners(this,a,!1)},EventEmitter.listenerCount=function(a,b){return'function'==typeof a.listenerCount?a.listenerCount(b):listenerCount.call(a,b)},EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(a){var b=this._events;if(b){var c=b[a];if('function'==typeof c)return 1;if(c)return c.length}return 0}EventEmitter.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};function spliceOne(a,b){for(var c=b,d=c+1,e=a.length;d<e;c+=1,d+=1)a[c]=a[d];a.pop()}function arrayClone(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function unwrapListeners(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}function objectCreatePolyfill(a){var b=function(){};return b.prototype=a,new b}function objectKeysPolyfill(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return c}function functionBindPolyfill(a){var b=this;return function(){return b.apply(a,arguments)}}

},{}],41:[function(require,module,exports){
'use strict';var range,hasAttributeNS,doc='undefined'!=typeof document&&document,testEl=doc?doc.body||doc.createElement('div'):{},NS_XHTML='http://www.w3.org/1999/xhtml',ELEMENT_NODE=1,TEXT_NODE=3,COMMENT_NODE=8;hasAttributeNS=testEl.hasAttributeNS?function(a,b,c){return a.hasAttributeNS(b,c)}:testEl.hasAttribute?function(a,b,c){return a.hasAttribute(c)}:function(a,b,c){return!!a.getAttributeNode(c)};function toElement(a){!range&&doc.createRange&&(range=doc.createRange(),range.selectNode(doc.body));var b;return range&&range.createContextualFragment?b=range.createContextualFragment(a):(b=doc.createElement('body'),b.innerHTML=a),b.childNodes[0]}function syncBooleanAttrProp(a,b,c){a[c]!==b[c]&&(a[c]=b[c],a[c]?a.setAttribute(c,''):a.removeAttribute(c,''))}var specialElHandlers={OPTION:function OPTION(a,b){syncBooleanAttrProp(a,b,'selected')},INPUT:function INPUT(a,b){syncBooleanAttrProp(a,b,'checked'),syncBooleanAttrProp(a,b,'disabled'),a.value!==b.value&&(a.value=b.value),hasAttributeNS(b,null,'value')||a.removeAttribute('value')},TEXTAREA:function TEXTAREA(a,b){var c=b.value;if(a.value!==c&&(a.value=c),a.firstChild){if(''===c&&a.firstChild.nodeValue===a.placeholder)return;a.firstChild.nodeValue=c}},SELECT:function SELECT(a,b){if(!hasAttributeNS(b,null,'multiple')){for(var c=0,d=b.firstChild;d;){var e=d.nodeName;if(e&&'OPTION'===e.toUpperCase()){if(hasAttributeNS(d,null,'selected')){break}c++}d=d.nextSibling}a.selectedIndex=c}}};function noop(){}function compareNodeNames(a,b){var c=a.nodeName,d=b.nodeName;return!(c!==d)||b.actualize&&91>c.charCodeAt(0)&&90<d.charCodeAt(0)&&c===d.toUpperCase()}function createElementNS(a,b){return b&&b!==NS_XHTML?doc.createElementNS(b,a):doc.createElement(a)}function morphAttrs(a,b){if(b.assignAttributes)b.assignAttributes(a);else{var c,d,e,f,g,h,i=b.attributes;for(c=i.length-1;0<=c;--c)d=i[c],e=d.name,f=d.namespaceURI,g=d.value,f?(e=d.localName||e,h=a.getAttributeNS(f,e),h!==g&&a.setAttributeNS(f,e,g)):(h=a.getAttribute(e),h!==g&&a.setAttribute(e,g));for(i=a.attributes,c=i.length-1;0<=c;--c)d=i[c],!1!==d.specified&&(e=d.name,f=d.namespaceURI,f?(e=d.localName||e,!hasAttributeNS(b,f,e)&&a.removeAttributeNS(f,e)):!hasAttributeNS(b,null,e)&&a.removeAttribute(e))}}function moveChildren(a,b){for(var c=a.firstChild;c;){var d=c.nextSibling;b.appendChild(c),c=d}return b}function defaultGetNodeKey(a){return a.id}function morphdom(a,b,c){function d(a){l?l.push(a):l=[a]}function e(a,b){if(a.nodeType===ELEMENT_NODE)for(var c,f=a.firstChild;f;)c=void 0,b&&(c=m(f))?d(c):(s(f),f.firstChild&&e(f,b)),f=f.nextSibling}function f(a,b,c){!1===r(a)||(b&&b.removeChild(a),s(a),e(a,c))}function g(a){if(a.nodeType===ELEMENT_NODE)for(var b,c=a.firstChild;c;)b=m(c),b&&(v[b]=c),g(c),c=c.nextSibling}function h(a){o(a);for(var b=a.firstChild;b;){var c=b.nextSibling,d=m(b);if(d){var e=v[d];e&&compareNodeNames(b,e)&&(b.parentNode.replaceChild(e,b),j(e,b))}h(b),b=c}}function j(c,e,g){var i,k=m(e);if(k&&delete v[k],!(b.isSameNode&&b.isSameNode(a))){if(!g){if(!1===p(c,e))return;if(morphAttrs(c,e),q(c),!1===t(c,e))return}if('TEXTAREA'!==c.nodeName){var l,o,r,s,u=e.firstChild,w=c.firstChild;outer:for(;u;){for(r=u.nextSibling,l=m(u);w;){if(o=w.nextSibling,u.isSameNode&&u.isSameNode(w)){u=r,w=o;continue outer}i=m(w);var x=w.nodeType,y=void 0;if(x===u.nodeType&&(x===ELEMENT_NODE?(l?l!==i&&((s=v[l])?w.nextSibling===s?y=!1:(c.insertBefore(s,w),o=w.nextSibling,i?d(i):f(w,c,!0),w=s):y=!1):i&&(y=!1),y=!1!==y&&compareNodeNames(w,u),y&&j(w,u)):(x===TEXT_NODE||x==COMMENT_NODE)&&(y=!0,w.nodeValue=u.nodeValue)),y){u=r,w=o;continue outer}i?d(i):f(w,c,!0),w=o}if(l&&(s=v[l])&&compareNodeNames(s,u))c.appendChild(s),j(s,u);else{var z=n(u);!1!==z&&(z&&(u=z),u.actualize&&(u=u.actualize(c.ownerDocument||doc)),c.appendChild(u),h(u))}u=r,w=o}for(;w;)o=w.nextSibling,(i=m(w))?d(i):f(w,c,!0),w=o}var A=specialElHandlers[c.nodeName];A&&A(c,e)}}if(c||(c={}),'string'==typeof b)if('#document'===a.nodeName||'HTML'===a.nodeName){var k=b;b=doc.createElement('html'),b.innerHTML=k}else b=toElement(b);var l,m=c.getNodeKey||defaultGetNodeKey,n=c.onBeforeNodeAdded||noop,o=c.onNodeAdded||noop,p=c.onBeforeElUpdated||noop,q=c.onElUpdated||noop,r=c.onBeforeNodeDiscarded||noop,s=c.onNodeDiscarded||noop,t=c.onBeforeElChildrenUpdated||noop,u=!0===c.childrenOnly,v={};g(a);var w=a,x=w.nodeType,y=b.nodeType;if(!u)if(x===ELEMENT_NODE)y===ELEMENT_NODE?!compareNodeNames(a,b)&&(s(a),w=moveChildren(a,createElementNS(b.nodeName,b.namespaceURI))):w=b;else if(x===TEXT_NODE||x===COMMENT_NODE){if(y===x)return w.nodeValue=b.nodeValue,w;w=b}if(w===b)s(a);else if(j(w,b,u),l)for(var z,A=0,i=l.length;A<i;A++)z=v[l[A]],z&&f(z,z.parentNode,!1);return!u&&w!==a&&a.parentNode&&(w.actualize&&(w=w.actualize(a.ownerDocument||doc)),a.parentNode.replaceChild(w,a)),w}module.exports=morphdom;

},{}],42:[function(require,module,exports){
'use strict';var minimalDesc=['h','min','s','ms','\u03BCs','ns'],verboseDesc=['hour','minute','second','millisecond','microsecond','nanosecond'],convert=[3600,60,1,1000000,1000,1];module.exports=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(c=!1,d=!1,b&&(c=b.verbose||!1,d=b.precise||!1),!Array.isArray(a)||2!==a.length)return'';if('number'!=typeof a[0]||'number'!=typeof a[1])return'';for(0>a[1]&&(l=a[0]+a[1]/1e9,a[0]=parseInt(l),a[1]=1e9*parseFloat((l%1).toPrecision(9))),k='',e=0;6>e&&(f=3>e?0:1,g=a[f],3!==e&&0!==e&&(g%=convert[e-1]),2===e&&(g+=a[1]/1e9),h=g/convert[e],!(1<=h&&(c&&(h=Math.floor(h)),d?j=h.toString():(i=10<=h?0:2,j=h.toFixed(i)),-1<j.indexOf('.')&&'0'===j[j.length-1]&&(j=j.replace(/\.?0+$/,'')),k&&(k+=' '),k+=j,c?(k+=' '+verboseDesc[e],'1'!==j&&(k+='s')):k+=' '+minimalDesc[e],!c)));e++);return k};

},{}],43:[function(require,module,exports){
'use strict';var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error('setTimeout has not been defined')}function defaultClearTimeout(){throw new Error('clearTimeout has not been defined')}(function(){try{cachedSetTimeout='function'==typeof setTimeout?setTimeout:defaultSetTimout}catch(a){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout='function'==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(a){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(a){if(cachedSetTimeout===setTimeout)return setTimeout(a,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(a,0);try{return cachedSetTimeout(a,0)}catch(b){try{return cachedSetTimeout.call(null,a,0)}catch(b){return cachedSetTimeout.call(this,a,0)}}}function runClearTimeout(a){if(cachedClearTimeout===clearTimeout)return clearTimeout(a);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(a);try{return cachedClearTimeout(a)}catch(b){try{return cachedClearTimeout.call(null,a)}catch(b){return cachedClearTimeout.call(this,a)}}}var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var a=runTimeout(cleanUpNextTick);draining=!0;for(var b=queue.length;b;){for(currentQueue=queue,queue=[];++queueIndex<b;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,b=queue.length}currentQueue=null,draining=!1,runClearTimeout(a)}}process.nextTick=function(a){var b=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];queue.push(new Item(a,b)),1!==queue.length||draining||runTimeout(drainQueue)};function Item(a,b){this.fun=a,this.array=b}Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title='browser',process.browser=!0,process.env={},process.argv=[],process.version='',process.versions={};function noop(){}process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(){return[]},process.binding=function(){throw new Error('process.binding is not supported')},process.cwd=function(){return'/'},process.chdir=function(){throw new Error('process.chdir is not supported')},process.umask=function(){return 0};

},{}],44:[function(require,module,exports){
'use strict';module.exports=require('./lib');

},{"./lib":49}],45:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},asap=require('asap/raw');function noop(){}var LAST_ERROR=null,IS_ERROR={};function getThen(a){try{return a.then}catch(a){return LAST_ERROR=a,IS_ERROR}}function tryCallOne(b,c){try{return b(c)}catch(a){return LAST_ERROR=a,IS_ERROR}}function tryCallTwo(c,d,a){try{c(d,a)}catch(a){return LAST_ERROR=a,IS_ERROR}}module.exports=Promise;function Promise(a){if('object'!==_typeof(this))throw new TypeError('Promises must be constructed via new');if('function'!=typeof a)throw new TypeError('Promise constructor\'s argument is not a function');this._h=0,this._i=0,this._j=null,this._k=null;a===noop||doResolve(a,this)}Promise._l=null,Promise._m=null,Promise._n=noop,Promise.prototype.then=function(a,b){if(this.constructor!==Promise)return safeThen(this,a,b);var c=new Promise(noop);return handle(this,new Handler(a,b,c)),c};function safeThen(a,b,c){return new a.constructor(function(d,e){var f=new Promise(noop);f.then(d,e),handle(a,new Handler(b,c,f))})}function handle(a,b){for(;3===a._i;)a=a._j;return(Promise._l&&Promise._l(a),0===a._i)?0===a._h?(a._h=1,void(a._k=b)):1===a._h?(a._h=2,void(a._k=[a._k,b])):void a._k.push(b):void handleResolved(a,b)}function handleResolved(a,b){asap(function(){var c=1===a._i?b.onFulfilled:b.onRejected;if(null===c)return void(1===a._i?resolve(b.promise,a._j):reject(b.promise,a._j));var d=tryCallOne(c,a._j);d===IS_ERROR?reject(b.promise,LAST_ERROR):resolve(b.promise,d)})}function resolve(a,b){if(b===a)return reject(a,new TypeError('A promise cannot be resolved with itself.'));if(b&&('object'===('undefined'==typeof b?'undefined':_typeof(b))||'function'==typeof b)){var c=getThen(b);if(c===IS_ERROR)return reject(a,LAST_ERROR);if(c===a.then&&b instanceof Promise)return a._i=3,a._j=b,void finale(a);if('function'==typeof c)return void doResolve(c.bind(b),a)}a._i=1,a._j=b,finale(a)}function reject(a,b){a._i=2,a._j=b,Promise._m&&Promise._m(a,b),finale(a)}function finale(a){if(1===a._h&&(handle(a,a._k),a._k=null),2===a._h){for(var b=0;b<a._k.length;b++)handle(a,a._k[b]);a._k=null}}function Handler(a,b,c){this.onFulfilled='function'==typeof a?a:null,this.onRejected='function'==typeof b?b:null,this.promise=c}function doResolve(a,b){var c=!1,d=tryCallTwo(a,function(a){c||(c=!0,resolve(b,a))},function(a){c||(c=!0,reject(b,a))});c||d!==IS_ERROR||(c=!0,reject(b,LAST_ERROR))}

},{"asap/raw":2}],46:[function(require,module,exports){
'use strict';var Promise=require('./core.js');module.exports=Promise,Promise.prototype.done=function(){var a=arguments.length?this.then.apply(this,arguments):this;a.then(null,function(a){setTimeout(function(){throw a},0)})};

},{"./core.js":45}],47:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},Promise=require('./core.js');module.exports=Promise;var TRUE=valuePromise(!0),FALSE=valuePromise(!1),NULL=valuePromise(null),UNDEFINED=valuePromise(void 0),ZERO=valuePromise(0),EMPTYSTRING=valuePromise('');function valuePromise(a){var b=new Promise(Promise._n);return b._i=1,b._j=a,b}Promise.resolve=function(a){if(a instanceof Promise)return a;if(null===a)return NULL;if(void 0===a)return UNDEFINED;if(!0===a)return TRUE;if(!1===a)return FALSE;if(0===a)return ZERO;if(''===a)return EMPTYSTRING;if('object'===('undefined'==typeof a?'undefined':_typeof(a))||'function'==typeof a)try{var b=a.then;if('function'==typeof b)return new Promise(b.bind(a))}catch(a){return new Promise(function(b,c){c(a)})}return valuePromise(a)},Promise.all=function(a){var b=Array.prototype.slice.call(a);return new Promise(function(a,c){function d(f,g){if(g&&('object'===('undefined'==typeof g?'undefined':_typeof(g))||'function'==typeof g)){if(g instanceof Promise&&g.then===Promise.prototype.then){for(;3===g._i;)g=g._j;return 1===g._i?d(f,g._j):(2===g._i&&c(g._j),void g.then(function(a){d(f,a)},c))}var h=g.then;if('function'==typeof h){var i=new Promise(h.bind(g));return void i.then(function(a){d(f,a)},c)}}b[f]=g,0==--e&&a(b)}if(0===b.length)return a([]);for(var e=b.length,f=0;f<b.length;f++)d(f,b[f])})},Promise.reject=function(a){return new Promise(function(b,c){c(a)})},Promise.race=function(a){return new Promise(function(b,c){a.forEach(function(a){Promise.resolve(a).then(b,c)})})},Promise.prototype['catch']=function(a){return this.then(null,a)};

},{"./core.js":45}],48:[function(require,module,exports){
'use strict';var Promise=require('./core.js');module.exports=Promise,Promise.prototype.finally=function(a){return this.then(function(b){return Promise.resolve(a()).then(function(){return b})},function(b){return Promise.resolve(a()).then(function(){throw b})})};

},{"./core.js":45}],49:[function(require,module,exports){
'use strict';module.exports=require('./core.js'),require('./done.js'),require('./finally.js'),require('./es6-extensions.js'),require('./node-extensions.js'),require('./synchronous.js');

},{"./core.js":45,"./done.js":46,"./es6-extensions.js":47,"./finally.js":48,"./node-extensions.js":50,"./synchronous.js":51}],50:[function(require,module,exports){
'use strict';var Promise=require('./core.js'),asap=require('asap');module.exports=Promise,Promise.denodeify=function(a,b){return'number'==typeof b&&b!==Infinity?denodeifyWithCount(a,b):denodeifyWithoutCount(a)};var callbackFn='function (err, res) {if (err) { rj(err); } else { rs(res); }}';function denodeifyWithCount(a,b){for(var c=[],d=0;d<b;d++)c.push('a'+d);var e=['return function ('+c.join(',')+') {','var self = this;','return new Promise(function (rs, rj) {','var res = fn.call(',['self'].concat(c).concat([callbackFn]).join(','),');','if (res &&','(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',') {rs(res);}','});','};'].join('');return Function(['Promise','fn'],e)(Promise,a)}function denodeifyWithoutCount(a){for(var b=Math.max(a.length-1,3),c=[],d=0;d<b;d++)c.push('a'+d);var e=['return function ('+c.join(',')+') {','var self = this;','var args;','var argLength = arguments.length;','if (arguments.length > '+b+') {','args = new Array(arguments.length + 1);','for (var i = 0; i < arguments.length; i++) {','args[i] = arguments[i];','}','}','return new Promise(function (rs, rj) {','var cb = '+callbackFn+';','var res;','switch (argLength) {',c.concat(['extra']).map(function(a,b){return'case '+b+':res = fn.call('+['self'].concat(c.slice(0,b)).concat('cb').join(',')+');break;'}).join(''),'default:','args[argLength] = cb;','res = fn.apply(self, args);','}','if (res &&','(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',') {rs(res);}','});','};'].join('');return Function(['Promise','fn'],e)(Promise,a)}Promise.nodeify=function(a){return function(){var b=Array.prototype.slice.call(arguments),c='function'==typeof b[b.length-1]?b.pop():null,d=this;try{return a.apply(this,arguments).nodeify(c,d)}catch(a){if(null===c||'undefined'==typeof c)return new Promise(function(b,c){c(a)});asap(function(){c.call(d,a)})}}},Promise.prototype.nodeify=function(a,b){return'function'==typeof a?void this.then(function(c){asap(function(){a.call(b,null,c)})},function(c){asap(function(){a.call(b,c)})}):this};

},{"./core.js":45,"asap":1}],51:[function(require,module,exports){
'use strict';var Promise=require('./core.js');module.exports=Promise,Promise.enableSynchronous=function(){Promise.prototype.isPending=function(){return 0==this.getState()},Promise.prototype.isFulfilled=function(){return 1==this.getState()},Promise.prototype.isRejected=function(){return 2==this.getState()},Promise.prototype.getValue=function(){if(3===this._i)return this._j.getValue();if(!this.isFulfilled())throw new Error('Cannot get a value of an unfulfilled promise.');return this._j},Promise.prototype.getReason=function(){if(3===this._i)return this._j.getReason();if(!this.isRejected())throw new Error('Cannot get a rejection reason of a non-rejected promise.');return this._j},Promise.prototype.getState=function(){return 3===this._i?this._j.getState():-1===this._i||-2===this._i?0:this._i}},Promise.disableSynchronous=function(){Promise.prototype.isPending=void 0,Promise.prototype.isFulfilled=void 0,Promise.prototype.isRejected=void 0,Promise.prototype.getValue=void 0,Promise.prototype.getReason=void 0,Promise.prototype.getState=void 0};

},{"./core.js":45}],52:[function(require,module,exports){
'use strict';var v1=require('./v1'),v4=require('./v4'),uuid=v4;uuid.v1=v1,uuid.v4=v4,module.exports=uuid;

},{"./v1":55,"./v4":56}],53:[function(require,module,exports){
'use strict';for(var byteToHex=[],i=0;256>i;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid(a,b){var c=b||0,d=byteToHex;return[d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],'-',d[a[c++]],d[a[c++]],'-',d[a[c++]],d[a[c++]],'-',d[a[c++]],d[a[c++]],'-',d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]]].join('')}module.exports=bytesToUuid;

},{}],54:[function(require,module,exports){
'use strict';var getRandomValues='undefined'!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||'undefined'!=typeof msCrypto&&'function'==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);module.exports=function(){return getRandomValues(rnds8),rnds8}}else{var rnds=Array(16);module.exports=function(){for(var a,b=0;16>b;b++)0==(3&b)&&(a=4294967296*Math.random()),rnds[b]=255&a>>>((3&b)<<3);return rnds}}

},{}],55:[function(require,module,exports){
'use strict';var _nodeId,_clockseq,rng=require('./lib/rng'),bytesToUuid=require('./lib/bytesToUuid'),_lastMSecs=0,_lastNSecs=0;function v1(a,c,d){var e=c&&d||0,f=c||[];a=a||{};var b=a.node||_nodeId,g=void 0===a.clockseq?_clockseq:a.clockseq;if(null==b||null==g){var h=rng();null==b&&(b=_nodeId=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==g&&(g=_clockseq=16383&(h[6]<<8|h[7]))}var i=void 0===a.msecs?new Date().getTime():a.msecs,j=void 0===a.nsecs?_lastNSecs+1:a.nsecs,k=i-_lastMSecs+(j-_lastNSecs)/1e4;if(0>k&&void 0===a.clockseq&&(g=16383&g+1),(0>k||i>_lastMSecs)&&void 0===a.nsecs&&(j=0),1e4<=j)throw new Error('uuid.v1(): Can\'t create more than 10M uuids/sec');_lastMSecs=i,_lastNSecs=j,_clockseq=g,i+=1.22192928e13;var l=(1e4*(268435455&i)+j)%4294967296;f[e++]=255&l>>>24,f[e++]=255&l>>>16,f[e++]=255&l>>>8,f[e++]=255&l;var m=268435455&1e4*(i/4294967296);f[e++]=255&m>>>8,f[e++]=255&m,f[e++]=16|15&m>>>24,f[e++]=255&m>>>16,f[e++]=128|g>>>8,f[e++]=255&g;for(var o=0;6>o;++o)f[e+o]=b[o];return c?c:bytesToUuid(f)}module.exports=v1;

},{"./lib/bytesToUuid":53,"./lib/rng":54}],56:[function(require,module,exports){
'use strict';var rng=require('./lib/rng'),bytesToUuid=require('./lib/bytesToUuid');function v4(a,b,c){var d=b&&c||0;'string'==typeof a&&(b='binary'===a?Array(16):null,a=null),a=a||{};var e=a.random||(a.rng||rng)();if(e[6]=64|15&e[6],e[8]=128|63&e[8],b)for(var f=0;16>f;++f)b[d+f]=e[f];return b||bytesToUuid(e)}module.exports=v4;

},{"./lib/bytesToUuid":53,"./lib/rng":54}],"catberry-logger":[function(require,module,exports){
'use strict';var Logger=require('./lib/Logger');module.exports={register:function register(a){var b=new Logger(a);a.registerInstance('logger',b)},Logger:Logger};

},{"./lib/Logger":5}],"catberry-uhr":[function(require,module,exports){
'use strict';var UHR=require('./lib/UHR');module.exports={register:function register(a){a.register('uhr',UHR,!0)},UHR:UHR};

},{"./lib/UHR":7}],"catberry":[function(require,module,exports){
'use strict';module.exports=require('./lib/Bootstrapper');

},{"./lib/Bootstrapper":15}]},{},[]);
